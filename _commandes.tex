%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% quelque couleurs
\definecolor{vertSombre}  {RGB} {  0,  95,  17}
%
\definecolor{jauneSombre}{RGB}  {213, 145,   2}
\definecolor{orangeSombre}{RGB} {174,  82,   0}
\definecolor{cyanSombre}  {RGB} {  0, 140, 128}
\definecolor{bleuPale}    {RGB} { 39,  76, 167}
%
\definecolor{jauneClair} {RGB} {218, 173,   0}
\definecolor{rougeSombre}{RGB} {148,  31,   0}
\definecolor{rougeClair} {RGB} {224,  39,  34}

%%% quelques couleurs dérivées des couleurs choisie
\newcommand{\couleurPrimSombre}{couleurPrim!60!black}

%%%% rectangle coloré
\NewDocumentCommand{\rectangle}{O{couleurPrim} m m}{%
  \shorthandoff{;}
  \tikz \node (rect) [draw, fill, color=#1,
              minimum width=#2,
              minimum height=#3] {};
  \shorthandon{;}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% une simple boite vide
\newtcolorbox{boite}[1][]{
  breakable, enhanced jigsaw, % pour s'étendre sur plusieurs pages
  arc = 0mm, % les lignes de la boites sont droites
  colback = white, colframe = black, % fond blanc et traits noirs
  #1
}

%%%% document
\newcounter{documentNum}
\newtcolorbox{doc}[3][]{
  before title = {\refstepcounter{documentNum}},
  breakable, enhanced jigsaw, % pour s'étendre sur plusieurs pages
  colback = white, % fond blanc
  colframe = couleurPrim!25!black, % couleur de la boite
  coltitle = black, % couleur du titre
  boxrule = 0.5mm, arc = 0.5mm, % largeur et arrondi des traits de la boite
  titlerule = 0mm, top = 0mm, % pour ne pas avoir de séparation titre/boite
  colbacktitle = white, % fond pour le titre blanc
  fonttitle = \bfseries\sffamily,
  title = {Document \arabic{documentNum} -- #2\strut \label{#3}},
  #1
}

%%%% Passage important à connaître
\newtcolorbox{encart}[1][]{
  breakable, enhanced jigsaw, % pour s'étendre sur plusieurs pages
  frame hidden, sharp corners, boxrule = 0mm, % pas de contours
  colback = couleurPrim!10, % fond
  borderline west={4pt}{0pt}{couleurPrim}, % barre gauche
  #1
}

%%%% contexte
\newtcolorbox{contexte}[1][]{
  breakable, enhanced jigsaw, % pour s'étendre sur plusieurs pages
  boxrule = 3pt, sharp corners, % contours droits
  colframe = couleurPrim, % couleur des contours
  colback = couleurPrim!5, % fond
  #1
}

%%%% Pour les objectifs
\newtcolorbox{boiteObjectifs}[2][]{
  empty, % pas de boite automatique
  attach boxed title to top left = {yshift=-2.5mm}, % position
  boxed title style = {empty, size = small, top = 1mm, bottom = 0.5mm},
  frame code = { % tracé de la boite
    \path (title.east |- frame.north) coordinate (aux);
    \path [draw=couleurPrim, line width = 3pt]
    (frame.west) |- ([xshift=-4mm] title.north east)
    to[out=0, in=180] ([xshift=10mm] aux) -| % définit la courbe
    (frame.east) |- (frame.south) -| cycle; % trace la boite
  },
  coltitle = black, % couleur du titre
  fonttitle = \bfseries\sffamily, % police du titre
  title = {#2},
  #1 
}
\newenvironment{objectifs}{
  \begin{boiteObjectifs}{Objectifs de la séance :}
    \begin{listeObjectifs}
}{
    \end{listeObjectifs}
  \end{boiteObjectifs}
}

%%%% Espace pour un coup de pouce
\newcounter{coupDePouceNum}
\newtcolorbox{coupDePouce}[1][]{
  before title = {\refstepcounter{coupDePouceNum}},
  breakable, enhanced jigsaw, % pour s'étendre sur plusieurs pages
  arc = 0mm, % les lignes de la boites sont droites
  colback = white, colframe = black, % fond blanc et traits noirs
  fonttitle = \bfseries, coltitle = black, % couleur et police du titre
  titlerule = 0mm, top = 0mm, % pour ne pas avoir de séparation titre/boite
  colbacktitle = white, % fond pour le titre blanc
  title = {
    \textcolor{couleurPrim}{\faThumbsUp}
    Coup de pouce \arabic{coupDePouceNum} :
    \flushright \vspace*{-26pt}\faSquareO
  },
  #1
}

%%%% Espace pour une appréciation
\newcommand{\appreciation}[1]{
  \begin{boite}
    \vspace*{-4pt}
    \sousTitre{Appréciation et remarques}
    
    \vspace*{#1 cm}
    \phantom{b}
  \end{boite}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% pagination et sections
\newcommand{\titre}[1]{
  \begin{center}
    \textsf{\bfseries \Large #1}
  \end{center}
}
\newcommand{\sousTitre}[1]{
  \textsf{\bfseries #1}
}
\newcommand{\pasDePagination}{
  \thispagestyle{empty}
}
\newcommand{\feuilleBlanche}{
  \newpage
  \phantom{b}
  \pasDePagination
}


%%%% activité ou TP
\newcounter{activiteNum}
\newcommand{\titreActi}[2]{
  \refstepcounter{activiteNum}
  \titre{#1 \arabic{section}.\arabic{activiteNum} -- #2}
}
\newcommand{\titreTP}[1]{
  \titreActi{TP}{#1}
  % \titreActi{Activité expérimentale}{#1}
}
\newcommand{\titreActivite}[1]{
  \titreActi{Activité}{#1}
}
\newcommand{\titreEvaluation}[1]{
  \titre{Évaluation \arabic{section} -- #1}
  % reset du numéro de page et d'exercices
  \setcounter{page}{1}
  \numeroActivite{1}
}


%%%% chapitre, section et sous-section
\newcommand{\titreChapitre}[1]{
  \titre{Chapitre \arabic{section} : #1}
}
\newcommand{\titrePartie}[1]{
  \vspace*{24pt}
  \refstepcounter{subsection}
  \rectangle{60pt}{1pt}
  \sousTitre{\Large \Roman{subsection} -- #1}
  \rectangle{60pt}{1pt}
  \vspace*{10pt}
}
\newcounter{sousSectionNum}
\newcommand{\titreSection}[1]{
  \vspace*{16pt}
  \refstepcounter{subsubsection}
  \setcounter{sousSectionNum}{0}
  \rectangle{30pt}{4pt}
  \sousTitre{\large \arabic{subsubsection} -- #1}
  \vspace*{10pt}
}
\newcommand{\titreSousSection}[1]{
  \vspace*{12pt}
  \refstepcounter{sousSectionNum}
  \sousTitre{\Alph{sousSectionNum} -- #1}
  \vspace*{8pt}
}

%%%% fixe le numéro de l'activité
\newcommand{\numeroActivite}[1]{
  % fixe les compteurs LaTeX
  \setcounter{page}{1}
  \setcounter{subsection}{0}
  \setcounter{subsubsection}{0}
  \setcounter{figure}{0}
  % fixe les compteurs internes
  \setcounter{qcmNum}{0}
  \setcounter{documentNum}{0}
  \setcounter{questionNum}{0}
  \setcounter{coupDePouceNum}{0}
  \setcounter{sousSectionNum}{0}
  \setcounter{activiteNum}{#1 - 1}
}
% fixe le numéro de partie (#1) et le numéro de la page (#2)
\newcommand{\numeroPartieCours}[2]{
  \newpage
  \setcounter{subsection}{#1 - 1}
  \setcounter{page}{#2}
}

%%%% lignes
\newcommand{\ligne}{
  \par\noindent\rule{\textwidth}{0.4pt}
}
\newcommand{\lignePointillee}[1]{
  \makebox[#1\linewidth]{\dotfill}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Paramètre par défaut pour l'en-tête
\newcommand{\annee}{Réglez avec \textbackslash renewcommand\{\textbackslash annee\}\{2023 -- 2024\}}
\newcommand{\classe}{Réglez avec \textbackslash renewcommand\{\textbackslash classe\}\{Seconde\}}
\newcommand{\etablissement}{Réglez avec \textbackslash renewcommand\{\textbackslash etablissement\}\{Lycée\}}

%%%% en-tête
\newcommand{\teteGauche}[2]{
  \lhead{
    \textbf{\footnotesize #1}
    \newline
    \footnotesize #2
  }
}
\newcommand{\teteDroite}[2]{
  \rhead{
    \hfill \textbf{\footnotesize #1}
    \newline \hfill
    \footnotesize #2
  }
}
\newcommand{\enTete}[3]{
  \pagestyle{fancy}
  \setcounter{section}{#3}
  \setcounter{subsection}{0}
  \setcounter{sousSectionNum}{0}
  \teteGauche{\etablissement{}}{Chapitre \arabic{section} -- #1} % left header
  \chead{} % central header
  \teteDroite{\annee{}}{#2} % right header
}
%
\newcommand{\enTeteFicheReussite}[1]{
  \newpage
  \setcounter{subsection}{0}
  \pasDePagination
  
  \phantom{b}
  \vspace*{-70pt}
  \titre{Fiche \og Réussir son évaluation \fg}
  \titre{#1}
  
  \vspace*{-6pt}
  % \titreSection{Ce que je dois savoir}
  
  Pour savoir quoi réviser, je lis les points clés du chapitre évalués :
  \begin{itemize}
    \item Si je pense maîtriser une notion, je coche la case \ok
    \item Si je pense que je dois la retravailler, je coche la case \pasOk
  \end{itemize}
  
  Pour travailler les notions qui ne sont pas maîtrisées, je reprend les activités associés.
}
\newcommand{\basDePageFicheReussite}{
  \titreSection{Ce qu'il me reste à faire}
}
\newcommand{\travailExerciceCorrige}{
  Pour être sûr-e d'obtenir une bonne note, je m'entraîne avec les exercices corrigés du manuel indiqués dans la colonne de droite.
}
\newcommand{\questionFicheReussite}[1]{
  S'il me reste des questions, je les note ici pour les poser au début de l'évaluation : 
  \lignesDeReponse{#1}
}
\newcommand{\coursFicheReussite}{
  Je prépare une fiche au format A4 avec toutes les notions, définitions ou grandeurs dont je pense avoir besoin pendant l'évaluation.
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% exercice
% définit un booléen pour entrer ou sortir du mode correction
\newboolean{modeProf}
\setboolean{modeProf}{false}
\newcommand{\modeCorrection}{
  \setboolean{modeProf}{true}
  \TeacherModeOn
}

% Pour afficher le numéro d'une question avec choix du compteur
\NewDocumentCommand{\numeroQuestion}{O{questionNum} O{16}}{
  \refstepcounter{#1}
  \vspace*{2pt}
  \hspace{#2pt}
  \textcolor{couleurSec}{
    \textbf{\arabic{#1}} {\small\faMinus}
  }
}

% Pour homogénéiser les commandes avec du texte corrigé
\newcommand{\texteCorrection}[1]{
  \textbf{\textcolor{couleurTer}{#1}}
}

% Pour simplifier la commande question
\newcommand{\reponseCorrigee}[1]{
  \vspace*{2pt}
  \textcolor{couleurSec}{\faCaretRight}
  \hspace{1pt}
  \texteCorrection{#1}
}


% trace des lignes pointillées pour répondre aux questions
% \lignessDeReponse* complète la ligne actuelle par des pointillées
% \lignesDeReponse commence à la ligne suivante
\newcounter{ligneNum}
\NewDocumentCommand{\lignesDeReponse}{s m}{
  % Trace la fin de la ligne, ou pas
  \IfBooleanTF{#1}{ % Version *
    \espaceReponse \dotfill
    \ifnum #2 < 1
      \newline
    \fi
  }{}
  % Trace le bon nombre de lignes
  \setcounter{ligneNum}{-1}
  \loop
    \stepcounter{ligneNum}
    \ifnum \value{ligneNum} < #2
      \\[8pt] \lignePointillee{0.98}
  \repeat
  \vspace*{1pt}
}


% définit une commande pour afficher une question 
% #1 : question
% #2 : réponse
% #3 : nombres de lignes pour répondre
\newcounter{questionNum}
\newcommand{\question}[3]{
  \numeroQuestion \!#1
  % pointille ou correction
  \ifthenelse {\boolean{modeProf}} { % prof
    \\[1pt] \reponseCorrigee{#2}
  }{ % eleve
    \lignesDeReponse{#3}
  }
}

% Correction affichée si en mode prof
\newcommand{\correction}[1]{
  \ifthenelse {\boolean{modeProf}} { % prof
    #1
  }{ % eleve
  }
}

% sous questions
\newcommand{\sousQuestion}[2]{
  \hspace{16pt}
  \textcolor{couleurSec}{\textbullet} #1
  
  \vspace*{8pt}
  \reponse{#2}
}

% question QCM
\newcommand{\QCM}[2]{
  \numeroQuestion[qcmNum][0] #1
  \begin{qcm}
    #2
  \end{qcm}
}

% À ajouter devant la bonne réponse dans un qcm
\newcounter{qcmNum}
\newcommand{\reponseQCM}{
  \correction{
    \hspace*{-15pt}$\checkmark$\hspace*{-12pt}
  } % Note : trace une croix à la bonne position
}

%%%% Pour afficher les compétences
\newcommand{\competence}[1]{
  ~{\footnotesize\textit{(#1)}}
}

%%%% Espace pour indiquer nom, prénom et classe
\newcommand{\nomPrenomClasse}{
  \vspace*{-24pt}
  Nom : \lignePointillee{0.3}
  Prénom : \lignePointillee{0.3}
  Classe : \dotfill
}
\newcommand{\nomPrenom}{
  \vspace*{-24pt}
  Nom : \lignePointillee{0.3}
  Prénom : \lignePointillee{0.3}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% texte à trou avec option pour régler la largeur
\NewDocumentCommand{\texteTrou}{o +m}{
  \IfValueTF{#1}{ % Si la largeur est réglée, on utilise des lignes
    \ifthenelse {\boolean{modeProf}} {% prof
      \texteCorrection{#2}
    }{% élève
      \espaceReponse
      \lignePointillee{#1}
      \hspace*{-12pt}
    }
  }{ % Sinon on utilise dash undergap pour la version automatique
    \ifthenelse{\boolean{modeProf}}{% prof
      \hspace*{-24pt}
    }{% élève
      \espaceReponse \hspace*{0.1pt}
    }
    \gap{\texteCorrection{#2}}
  }
}

% texte à trou avec option pour laisser plusieurs lignes
\NewDocumentCommand{\texteTrouLignes}{O{0} +m}{
  \ifthenelse {\boolean{modeProf}} {% prof
    \texteCorrection{#2}
  }{% élève
    \lignesDeReponse*{#1}
  }
}

% espace vertical pour la réponse
\newcommand{\espaceReponse}{
  \phantom{$\dfrac{1}{1}$} % espace vertical
  \hspace*{-38pt} \phantom{b} % ajuste l'espace horizontal
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Pour choisir parmi deux sujets
\newboolean{sujetA}
\setboolean{sujetA}{true}
\newcommand{\sujetB}{
  \setboolean{sujetA}{false}
}
\newcommand{\sujetA}{
  \setboolean{sujetA}{true}
}

%%%% Pour faire plusieurs sujets en parallèle
\newcommand{\variationSujet}[2]{
  \hspace*{-6pt}
  \ifthenelse {\boolean{sujetA}}{#1}{#2}
  \hspace*{-6pt}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Tableau générique avec la première ligne bleue
\NewDocumentEnvironment{tableau}{m}{
  \begin{center}
  \begin{tblr}{
    hlines,
    colspec = #1,
    row{1} = {couleurPrim!20},
  }
}{
  \end{tblr}
  \end{center}
}

%%%% Tableau de competence
\newenvironment{tableauCompetences}{
  \centering
  \begin{tblr}{
    colspec = {| c | X[l] | c | c | c | c |},
    rows = {m}, hlines,
    row{1} = {couleurPrim!20}
  }
    \textbf{Compétences} & \centering \textbf{Items} 
    & \textbf{D} & \textbf{C} & \textbf{B} & \textbf{A} \\
}{
  \end{tblr}
}

%%%% Tableau de connaissances
\newenvironment{tableauConnaissances}{
  \centering
  \begin{tblr}{
    colspec = {| X[c] | c | c | c | c |},
    rows = {m}, hlines,
    column{4} = {0.22},
    column{5} = {0.21},
    row{1} = {couleurPrim!20}
  }
    \textbf{Points clés du chapitre} & \ok & \pasOk
    & \textbf{En classe} & \textbf{Exercices} \\
}{   
  \end{tblr}
}

%%%% Tableau de connaissances sans exercices
\newenvironment{tableauConnaissancesSansExercices}{
  \centering
  \begin{tblr}{
    colspec = {| X[l,m] | c | c | c |},
    rows = {m}, hlines,
    column{4} = {0.2},
    row{1} = {couleurPrim!20}
  }
    \centering \textbf{Points clés du chapitre} & \ok & \pasOk
    & \textbf{En classe} \\
}{ 
  \end{tblr}
}

%%%% Tableau de correction élève
\newcommand{\correctionEleve}[1]{
  \begin{tblr}{
    hlines,
    colspec = {| X[-1, c] | X[2, c] | X[2, c] | X[2, c] |},
    row{1} = {couleurPrim!20}
  }
    \textbf{Question} & 
    \textbf{L'erreur} &
    \textbf{Analyse de l'erreur} &
    \textbf{La correction} \\
    %
    \phantom{b} \vspace{#1 pt} & & & \\
    \phantom{b} \vspace{#1 pt} & & & \\
    \phantom{b} \vspace{#1 pt} & & & \\
    \phantom{b} \vspace{#1 pt} & & & \\
  \end{tblr}
}

%%%% Tableau bilan de la correction
\newcommand{\bilanCorrection}[1]{
  \begin{tblr}{
    hlines,
    colspec = {| X[c] | X[c] |},
    row{1} = {couleurPrim!20}
  }
    \textbf{Ce que je n'avais pas compris...} &
    \textbf{Ce que maintenant j'ai compris...} \\
    \phantom{b} \vspace{#1 pt} & \\
  \end{tblr}
}


%%%% Alignement dans un tableau
\newcommand{\vAligne}[1]{
  \strut \\ \vspace*{#1}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% symboles : chevron, flèche, attention, etc.
\NewDocumentCommand{\chevron}{O{couleurPrim}}{
  \textcolor{#1}{\small \faChevronRight}
}
%
\NewDocumentCommand{\fleche}{O{couleurPrim}}{
  \textcolor{#1}{\faCaretRight}
}
%
\NewDocumentCommand{\attention}{O{couleurPrim}}{
  \textcolor{#1}{\faExclamationTriangle}
}
%
\NewDocumentCommand{\flecheLongue}{O{couleurPrim}}{
  \textcolor{#1}{\faLongArrowRight}
}
%
\NewDocumentCommand{\ok}{O{couleurPrim}}{
  \textcolor{#1}{\faCheckCircle}
}
%
\NewDocumentCommand{\pasOk}{O{couleurPrim}}{
  \textcolor{#1}{\faTimesCircle}
}
%
\NewDocumentCommand{\pointCyan}{O{couleurPrim}}{
  \textcolor{#1}{\textbullet}
}
%
\NewDocumentCommand{\mesure}{O{couleurPrim}}{
  \hspace{15pt}
  \textcolor{couleurSec}{\faWrench\faFlask}
}
% pictogramme sécurité
\newcommand{\picto}[2]{
  \image{#1}{images/pictogrammes/picto_#2}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% emphase
\newcommand{\emphase}[1]{
  \textcolor{couleurSec}{\textsf{\bfseries \large #1}}
}
%
\newcommand{\important}[1]{
  \!\textcolor{couleurSec}{\textsf{\bfseries #1}}\!\!
}
%
\newcommand{\exemple}{
  \flecheLongue \textit{Exemple :}
}
\newcommand{\exemples}{
  \flecheLongue \textit{Exemples :}
}
%
\newcounter{compteAppelProf}
\newcommand{\appelProf}{
  \refstepcounter{compteAppelProf}
  \hspace{24pt} \faHandPaperO \hspace{2pt}
  \textbf{Appel n$^\circ$ \arabic{compteAppelProf} :}
}


%%%% image
\newcommand{\image}[2]{
  \includegraphics[width=#1\linewidth]{#2}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% qcm
\newlist{qcm}{itemize}{2}
\setlist[qcm]{label=$\square$, leftmargin=2cm}

%%%% liste d'objectif
\newlist{listeObjectifs}{itemize}{2}
\setlist[listeObjectifs]{label = \chevron}

%%%% protocole
\newlist{protocole}{itemize}{2}
\setlist[protocole]{label = {\footnotesize \fleche[couleurSec]}}

%%%% liste de points
\newlist{listePoints}{itemize}{2}
\setlist[listePoints]{label = \pointCyan}

%%%% liste tirets
\newlist{listeTirets}{itemize}{2}
\setlist[listeTirets]{label = \textcolor{couleurPrim}{\small\faMinus}}

%%%% liste avec des flèches
\newlist{listeFleche}{itemize}{2}
\setlist[listeFleche]{label = \textbf{\flecheLongue}}

%%%% jeu de données
\newenvironment{donnees}{
  
  \textbf{Données :}
  \vspace*{-8pt}
  \begin{multicols}{2}
    \begin{listeTirets}
}{
    \end{listeTirets}
  \end{multicols}
}

%%%% problematique
\newcommand{\problematique}[1]{
  \hspace{8pt}
  \flecheLongue
  \textbf{#1}
}

%%%% liste avec chiffre
\newlist{enumeration}{enumerate}{2}
\setlist[enumeration]{label = \textcolor{\couleurPrimSombre}{\textbf{\arabic*.}} }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Séparation de la page en blocs
\newcommand{\separationTroisBlocs}[3]{
  \begin{minipage}[T]{0.3\linewidth}
    #1
  \end{minipage}
  ~
  \begin{minipage}[T]{0.3\linewidth}
    #2
  \end{minipage}
  ~
  \begin{minipage}[T]{0.3\linewidth}
    #3
  \end{minipage}
}
%%%% Separation en deux blocs
\NewDocumentCommand{\separationBlocs}{+m O{0.48} +m O{0.48}}{
  \begin{minipage}[T]{#2\linewidth}
    #1
  \end{minipage}
  \hfill
  \begin{minipage}[T]{#4\linewidth}
    #3
  \end{minipage}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% nombre algébrique, réaction
\newcommand{\algebrique}[1]{
  \overline{\mathrm{#1}}
}
\newcommand{\reaction}{
  \!\!\schemestart \arrow(.mid east--.mid west){->}[, 0.9, ultra thick] \schemestop\!\!
}

%% Pour simplifier l'écriture des formules brutes
\newcommand{\bruteCHO}[3]{
  \chemfig{C_{#1} H_{#2} O_{#3}}
}

%% pour les masse molaire et atomique
\newcommand{\masseMol}[1]{
  M(\chemfig{#1})
  % M_{\chemfig{#1}}
}
\newcommand{\masseAtom}[1]{
  m(\chemfig{#1})
  % m_{\chemfig{#1}}
}


%% atome ou isotope
\makeatletter
\newcommand{\isotope}[3]{%
   \settowidth\@tempdimb{\ensuremath{\scriptstyle#1}}%
   \settowidth\@tempdimc{\ensuremath{\scriptstyle#2}}%
   \ifnum\@tempdimb>\@tempdimc%
       \setlength{\@tempdima}{\@tempdimb}%
   \else%
       \setlength{\@tempdima}{\@tempdimc}%
   \fi%
  \begingroup%
  \ensuremath{
    ^{\makebox[\@tempdima][r]{\ensuremath{\scriptstyle#1}}}
    _{\makebox[\@tempdima][r]{\ensuremath{\scriptstyle#2}}}
    \chemfig{#3}
  }%
  \endgroup%
}%
\makeatother

%% element chimique dans le tableau périodique
\makeatletter
\newcommand{\element}[2]{%
   \settowidth\@tempdimb{\ensuremath{\footnotesize #1}}%
  \begingroup%
  \ensuremath{
    _{\makebox[\@tempdimb][r]{\ensuremath{\small #1}}} 
    \chemfig[atom style={scale=1.3}]{#2}
  }%
  \endgroup%
}%
\makeatother

%% siècle
\newcommand{\siecle}[1]{
  \textsc{\romannumeral #1}\textsuperscript{e}~siècle
}

%% texte avec une boite autour
\newcommand{\texteEncadre}[1]{
  \frame{
    \vphantom{$\dfrac{1}{10}$} \text{#1}
  }
}

%% case cochée
\newcommand{\caseCochee}{
  $\text{\rlap{$\checkmark$}}\square$
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Couleur pour le code
\definecolor{vertCode}  {rgb}{0.2,0.6,0}
\definecolor{grisCode}  {rgb}{0.5,0.5,0.5}
\definecolor{violetCode}{rgb}{0.58,0,0.82}
\definecolor{fondCode}  {rgb}{0.95,0.95,0.92}
%%%% Style python
\lstdefinestyle{codePython}{
  backgroundcolor=\color{fondCode},
  commentstyle=\color{magenta},
  keywordstyle=\color{vertCode},
  numberstyle=\tiny\color{grisCode},
  stringstyle=\color{violetCode},
  basicstyle=\ttfamily\footnotesize,
  breakatwhitespace=false,
  breaklines=true,
  captionpos=b,
  keepspaces=true,
  numbers=left,
  numbersep=5pt, 
  showspaces=false,
  showstringspaces=false,
  showtabs=false, 
  tabsize=2
}
\def\inline{\lstinline[style=codePython,language=python]}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% circuit tikz
\NewDocumentCommand{\fixedvlen}{O{0.5cm} m m O{}}{% [semilength]{node}{label}[extra options]
  % get the center of the standard arrow
  \coordinate (#2-Vcenter) at ($(#2-Vfrom)!0.5!(#2-Vto)$);
  % draw an arrow of a fixed size around that center and on the same line
  \draw[-Triangle, #4] ($(#2-Vcenter)!#1!(#2-Vfrom)$) -- ($(#2-Vcenter)!#1!(#2-Vto)$);
  % position the label as in the normal voltages
  \node[anchor=\ctikzgetanchor{#2}{Vlab}, #4] at (#2-Vlab) {#3};
}
