% Author............: A. Jedrecy
% licence...........: CC BY-SA 4.0
% code

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{biomolecules}[2025/07/10 1.0.0 Quelques commandes pour tracer des biomolécules au lycée]
% 1.0.0 Version de base avec la plupart des molécules utiles pour la filière ST2S.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%------ Chemfig
\RequirePackage{chemfig}

%----- Réglage de chemfig
\newcommand{\chemfigParDefaut}{
  \setchemfig{
    atom sep= 24pt,
    double bond sep = 3pt,
    bond style = {line width = 1.1pt},
    cram width = 2.2pt,
    angle increment = 30
  }
}
\chemfigParDefaut

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Pour faire des parenthèses dans les molécules 
\def\parentheseG{\llap{$\left(\strut\right.$}}
\def\parentheseD{\rlap{$\left.\strut\right)$}}

%% Pour avoir des molécules en gras dans un texte
\newcommand{\moleculesGras}{ \renewcommand*\printatom[1]{\ensuremath{\mathbf{##1}}} }
\newcommand{\moleculesNormales}{ \renewcommand*\printatom[1]{\ensuremath{\mathrm{##1}}} }

%------ Éléments récurrents 
\newcommand{\hydrogene}{\chemfig{H}\xspace}
\newcommand{\carbone}  {\chemfig{C}\xspace}
\newcommand{\oxygene}  {\chemfig{O}\xspace}
\newcommand{\azote}    {\chemfig{N}\xspace}
\newcommand{\phosphore}{\chemfig{P}\xspace}
\newcommand{\electron} {\chemfig{e^{-}}\xspace}
%------ Molécules récurrentes
\newcommand{\dioxygene}          {\chemfig{O_2}\xspace}
\newcommand{\dihydrogene}        {\chemfig{H_2}\xspace}
\newcommand{\diazote}            {\chemfig{N_2}\xspace}
\newcommand{\dichlore}           {\chemfig{Cl_2}\xspace}
\newcommand{\dioxydeDeCarbone}   {\chemfig{CO_2}\xspace}
\newcommand{\eau}                {\chemfig{H_2O}\xspace}
\newcommand{\eauOxygenee}        {\chemfig{H_2O_2}\xspace}
\newcommand{\methane}            {\chemfig{CH_4}\xspace}
\newcommand{\propane}            {\chemfig{C_3H_8}\xspace}
\newcommand{\ammoniac}           {\chemfig{NH_3}\xspace}
\newcommand{\diiode}             {\chemfig{I_2}\xspace}
\newcommand{\acideCarbonique}    {\chemfig{H_2 CO_3}\xspace}
\newcommand{\carbonateDeCalcium} {\chemfig{Ca CO_3}\xspace}
\newcommand{\bicarbonateDeSodium}{\chemfig{Na HCO_3}\xspace}
\newcommand{\azotureDeSodium}    {\chemfig{Na N_3}\xspace}
\newcommand{\chlorureDArgent}    {\chemfig{Ag Cl}\xspace}
\newcommand{\nitrateAmmonium}    {\chemfig{NH_4 NO_3}\xspace}
%------ Ions récurrents
\newcommand{\oxonium}       {\chemfig{H_3O^{+}}\xspace}
\newcommand{\hydroxyde}     {\chemfig{HO^{-}}\xspace}
\newcommand{\ionHydrogene}  {\chemfig{H^{+}}\xspace}
\newcommand{\ammonium}      {\chemfig{NH_4^{+}}\xspace}
\newcommand{\nitrate}       {\chemfig{NO_3^{-}}\xspace}
\newcommand{\nitrite}       {\chemfig{NO_2^{-}}\xspace}
\newcommand{\sulfate}       {\chemfig{SO_4^{2-}}\xspace}
\newcommand{\permanganate}  {\chemfig{MnO_4^{-}}\xspace}
\newcommand{\chlorure}      {\chemfig{Cl^{-}}\xspace}
\newcommand{\fluorure}      {\chemfig{F^{-}}\xspace}
\newcommand{\iodure}        {\chemfig{I^{-}}\xspace}
\newcommand{\carbonate}     {\chemfig{CO_3^{2-}}\xspace}
\newcommand{\bicarbonate}   {\chemfig{HCO_3^{-}}\xspace}
\newcommand{\ionOxygene}    {\chemfig{O^{2-}}\xspace}
\newcommand{\ionFerII}      {\chemfig{Fe^{2+}}\xspace}
\newcommand{\ionFerIII}     {\chemfig{Fe^{3+}}\xspace}
\newcommand{\ionSodium}     {\chemfig{Na^{+}}\xspace}
\newcommand{\ionArgent}     {\chemfig{Ag^{+}}\xspace}
\newcommand{\hypochlorite}  {\chemfig{ClO^{-}}\xspace}
\newcommand{\ionCuivreII}   {\chemfig{Cu^{2+}}\xspace}
\newcommand{\ionCalcium}    {\chemfig{Ca^{2+}}\xspace}
\newcommand{\ionMagnesium}  {\chemfig{Mg^{2+}}\xspace}
\newcommand{\ionManganeseII}{\chemfig{Mn^{2+}}\xspace}
\newcommand{\ionPotassium}  {\chemfig{K^{+}}\xspace}
\newcommand{\ionPhosphate}  {\chemfig{HPO_4^{2-}}\xspace}

%------ État physique
\newcommand{\aq} {\ensuremath{_\text{(aq)}}\xspace}
\newcommand{\sol}{\ensuremath{_\text{(s)}}\xspace}
\newcommand{\liq}{\ensuremath{_\text{(l)}}\xspace}
\newcommand{\gaz}{\ensuremath{_\text{(g)}}\xspace}

%------ Pour simplifier l'écriture des formules brutes
% #1 : # carbone, #2 : # hydrogène, #3 : oxygène
\newcommand{\bruteCHO}[3]{%
  \chemfig{C_{#1} H_{#2} O_{#3}}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%------ Pour simplifier certaines molécules
\definesubmol\vide1{ -[#1,,,, draw = none] } % liaison invisible avec angle et longueur réglable
\definesubmol\lh   { -[::60] }  % C-C vers le haut (liaison haut)
\definesubmol\lb   { -[::-60] } % "              " (liaison bas)
\definesubmol\lhb  { -[::60] -[::-60] } % Liaison C-C-C ^ (liaison haut bas)
\definesubmol\lbh  { -[::-60] -[::60] } % "           " v (liaison bas haut)
\definesubmol\llh  { =[::60] }  % Double liaison = vers le haut
\definesubmol\llb  { =[::-60] } % "                      " bas
\definesubmol\cis  { -[::60] =[::-60] -[::-60] } % Liaison -C=C- cis
\definesubmol\trans{ -[::60] =[::-30] -[::-30] } % Liaison -C=C- trans
\definesubmol\ldh  { -[::50] }  % liaison développée vers le haut
\definesubmol\ldb  { -[::-50] } % "                        " bas
\definesubmol\lldh { =[::50] }  % double liaison développée vers le haut
\definesubmol\lldb { =[::-50] } % "                               " bas  ""
\definesubmol\cram2{
  (>:[::-150] #1) 
  (<#(4pt,4pt)[::-100,1.2] #2)
}
\definesubmol\branche2  {
  (-[::-90] #1)
  (-[::90] #2)
}
\definesubmol\triesterDev2{
  HC                    (#2)
  (-[::90,1.7,2,2] H_2C (#1))
  -[::-90,1.7,2,2] H_2C
}  
\definesubmol\triesterSat2{
  [:-90] O (-[::180] !\carbonyle #1) !\lhb 
  (!\lh O !\lh !\carbonyle #2) !\lbh
  O !\lh (!\llb O) !\lh 
}
\definesubmol\triester3{
  O *6( (-!\carbonyle #1) -- 
  (-O !\lh !\carbonyle #2) --
  O (- !\carbonyle #3) )
}
\definesubmol\glycero1{
  O !\lbh (!\lh O #1) !\lbh O
}

%------ Hydrogènes saturés et groupement fréquents
\definesubmol\HH {(-[::90] H) (-[::-90] H)} % paire H- R -H
\definesubmol\HHH{!\HH (-[::0] H)} % triplet H- RH -H
\definesubmol\NH {\chembelow{N}{H}}
\definesubmol\HN {\chemabove{N}{H}}
\definesubmol\CH {\chembelow{C}{H}}
\definesubmol\HC {\chemabove{C}{H}}
%% Quelques groupes caractéristiques
\definesubmol\tete{ !\vide{-90,0.01} } % Pour passer en tête les groupes carboxyle développée
\definesubmol\carboxyle   [ HO-[:30] (!\llh O) !\lb ]{ (!\llh O) (!\lb OH) }
\definesubmol\carboxyleDev[ !\vide{:0,0.7} -O-C (=[::90] O) - ]{ (!\lldh O) (!\ldb OH) }
\definesubmol\carbonyle   { (!\llh O) !\lb }
\definesubmol\carbonyleDev{ (!\lldh O) !\ldb }
\definesubmol\ester       { (!\llh O) !\lb O}
\definesubmol\ether       { !\lh O !\lb}
\definesubmol\amide       { (!\llh O) !\lb N}
\definesubmol\phosphate   { P (=[::-90] O) (-[::90] \charge{45:1.5pt=$\scriptstyle-$}{O}) -[::0] O}

%------ Pour des molécules colorées
\definesubmol\lCouleur1 {-[ ::#1,,,, couleurQuat-700, line width = 2.pt]}
\definesubmol\llCouleur1 {-[ ::#1,,,, couleurQuat-700, line width = 1.5pt]}
\definesubmol\lhCouleur {-[ ::60,,,, couleurQuat-700, line width = 2.pt]}
\definesubmol\lbCouleur {-[::-60,,,, couleurQuat-700, line width = 2.pt]}
\definesubmol\llhCouleur{=[ ::60,,,, couleurQuat-700, line width = 1.5pt]}
\definesubmol\llbCouleur{=[::-60,,,, couleurQuat-700, line width = 1.5pt]}
\definesubmol\couleur1  {\textcolor{couleurQuat-700}{#1}}

%------ Pour surligner certaines fonctions organiques
\pgfkeys{
  /chemPoly/.is family, /chemPoly,
  defaut/.style = {
    bords = 6,
    rotation = 90,
    arrondi = 4pt,
    atom sep = 24pt,
    couleur = cyan-200,
  },% stockage des clefs
  atom sep/.store in = \chemAtomSep,
  couleur/.store in = \chemCouleur,
  rotation/.store in = \chemRotation,
  arrondi/.store in = \chemArrondi,
  bords/.store in = \chemBords,
}
%
\NewDocumentCommand{\chemAmine}{O{} r()}{
  \pgfkeys{/chemPoly, defaut, couleur = blue-200 ,#1}
  \coordinate (A) at (#2);
  \fill[\chemCouleur, rounded corners = \chemArrondi]
    (A) rectangle ($(A) + \chemAtomSep*(1.3pt, -1pt)$);
}
%
\NewDocumentCommand{\chemAmide}{O{} r()}{
  \pgfkeys{/chemPoly, defaut, couleur = purple-200 ,#1}
  \coordinate (A) at (#2);
  \fill[\chemCouleur, rounded corners = \chemArrondi, rotate = 30]
    (A) rectangle ($(A) + 1.5*\chemAtomSep*(1.1pt,-2/3pt)$);
  % Entoure la partie aminée
  \fill[\chemCouleur, rounded corners = \chemArrondi]
    ($(A) + 1.5*\chemAtomSep*(0.6pt, -0.05pt)$) rectangle
    ($(A) + 1.5*\chemAtomSep*(1.3pt, 0.8pt)$);
  % Entoure la partie carbonylée
  \fill[\chemCouleur, rounded corners = \chemArrondi]
    (A) rectangle ($(A) + \chemAtomSep*(1.1pt, -1.6pt)$);
}
%
\NewDocumentCommand{\chemAmideDevBH}{O{} r()}{
  \pgfkeys{/chemPoly, defaut, couleur = purple-200 ,#1}
  \coordinate (A) at ($(#2) - 1.5*\chemAtomSep*(0pt, 1/3pt)$);
  % Partie carbonyle
  \fill[\chemCouleur, rounded corners = \chemArrondi]
    ($(A) + 1.5*\chemAtomSep*(0, 2/3pt)$) rectangle
    ($(A) - 1.5*\chemAtomSep*(4/5pt, 2/3pt)$);
  % Partie amine
  \fill[\chemCouleur, rounded corners = \chemArrondi]
    ($(A) - 1.5*\chemAtomSep*(0.1pt, 0)$) rectangle
    ($(A) + 1.5*\chemAtomSep*(2/3pt, 4/3pt)$);
}
%
\NewDocumentCommand{\chemAmideDevHB}{O{} r()}{
  \pgfkeys{/chemPoly, defaut, couleur = purple-200 ,#1}
  \coordinate (A) at ($(#2) - 1.5*\chemAtomSep*(0pt, 1/3pt)$);
  % Partie carbonyle
  \fill[\chemCouleur, rounded corners = \chemArrondi]
    ($(A) + 1.5*\chemAtomSep*(-0.1pt, 2/3pt)$) rectangle
    ($(A) - 1.5*\chemAtomSep*(-2/3pt, 2/3pt)$);
  % Partie amine
  \fill[\chemCouleur, rounded corners = \chemArrondi]
    (A) rectangle ($(A) + 1.5*\chemAtomSep*(-3/4pt, 4/3pt)$);
}
%
\NewDocumentCommand{\chemCarboxyle}{O{} r()}{
  \pgfkeys{/chemPoly, defaut, couleur = red-100 ,#1}
  \coordinate (A) at (#2);
  % Entoure =O
  \fill[\chemCouleur, rounded corners = \chemArrondi, rotate = 30]
    (A) rectangle ($(A) + 1.5*\chemAtomSep*(1.1pt,-2/3pt)$);
  % Entoure -OH
  \fill[\chemCouleur, rounded corners = \chemArrondi]
    (A) rectangle ($(A) + \chemAtomSep*(1.25pt, -1.75pt)$);
}
%
\NewDocumentCommand{\chemCarboxyleDev}{O{} r()}{
  \pgfkeys{/chemPoly, defaut, couleur = red-100 ,#1}
  \coordinate (A) at ($(#2) + 1.5*\chemAtomSep*(0pt, 1/3pt)$);
  % Entoure le carboxyle
  \fill[\chemCouleur, rounded corners = \chemArrondi, rotate = 50]
    ($(A) - 1.5*\chemAtomSep*(0.7pt,0)$) rectangle
    ($(A) + 1.5*\chemAtomSep*(0.65pt, 0.75pt)$);
  \fill[\chemCouleur, rounded corners = \chemArrondi, rotate = -40]
    ($(A) - 1.5*\chemAtomSep*(2/3pt,0)$) rectangle
    ($(A) + 1.5*\chemAtomSep*(0.7pt, -0.75pt)$);
}
%
\NewDocumentCommand{\chemPolygone}{O{} r()}{
  \pgfkeys{/chemPoly, defaut, #1}
  \node [
    regular polygon, fill = \chemCouleur,
    regular polygon sides = \chemBords, 
    inner sep = \fpeval{\chemAtomSep * \chemBords * 0.103} pt,
    rotate = \chemRotation,
  ] at (#2) {};
}
%
\NewDocumentCommand{\chemPentagoneHaw}{O{} r()}{
  \pgfkeys{/chemPoly, defaut, couleur = orange-150, #1}
  \coordinate (A) at (#2);
  \fill [fill = \chemCouleur] 
    (A) --
    ($(A) + 1.4*\chemAtomSep*(0.833pt, 0.5pt)$) --
    ($(A) + 1.4*\chemAtomSep*(1.667pt, 0pt)$) --
    ($(A) + 1.4*\chemAtomSep*(1.25pt, -0.667pt)$) --
    ($(A) + 1.4*\chemAtomSep*(0.375pt, -0.667pt)$) --
    cycle;
}
%
\NewDocumentCommand{\chemHexagoneHaw}{O{} r()}{
  \pgfkeys{/chemPoly, defaut, couleur = green-200, #1}
  \coordinate (A) at (#2);
  \fill [fill = \chemCouleur] 
    (A) --
    ($(A) + \chemAtomSep*(0.5833pt, -0.6875pt)$) --
    ($(A) + \chemAtomSep*(1.679pt, -0.6875pt)$) --
    ($(A) + \chemAtomSep*(2.275pt, -0.021pt)$) --
    ($(A) + \chemAtomSep*(1.617pt, 0.6pt)$) --
    ($(A) + \chemAtomSep*(0.6417pt, 0.6pt)$) --
    cycle;
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Pour l'utilisation dans les triglycérides
\definesubmol\tricaproique     { !\lhb !\lhb !\lh }
\definesubmol\trilaurique      { !\lhb !\lhb !\lhb !\lhb !\lhb}
\definesubmol\tripalmitique    { !\lhb !\lhb !\lhb !\lhb !\lhb !\lhb !\lh }
\definesubmol\trilinolenique   { !\lhb !\lhb !\lhb !\cis !\cis !\cis !\lh }
\definesubmol\trioleique       { !\lhb !\lhb !\lhb !\lh!\llh!\lh !\lhb !\lhb !\lb!\lb!\lb }
\definesubmol\trilinoleique    { !\lhb !\lhb !\lhb !\cis !\cis !\lhb !\lhb }
\definesubmol\trieicosapenta   { !\lh !\lh !\cis !\cis !\cis !\cis !\cis !\lh }
\definesubmol\triarachidonique { !\lh !\lh !\cis !\cis !\cis !\cis !\lh !\lhb !\lh }
\definesubmol\tridocosahexa    { !\lh !\cis !\cis !\lh !\llh !\lh !\cis !\cis !\cis !\lh }
%% Formes semi-developpées
\definesubmol\tristeraiqueSemiDev { !\tete !\carboxyleDev C_{17} H_{35} }
\definesubmol\tricaproiqueSemiDev { !\tete !\carboxyleDev CH_2 - CH_2 - CH_2 - CH_2 - CH_3 }
\definesubmol\trioleiqueSemiDev   { !\tete !\carboxyleDev C_{17} H_{33} }
\definesubmol\tripalmitiqueSemiDev{ !\tete !\carboxyleDev C_{15} H_{31} }
%% Acides gras
\definesubmol\caproique         { !\tete !\carboxyle !\tricaproique }
\definesubmol\palmitique        { !\tete !\carboxyle !\tripalmitique !\lb }
\definesubmol\linolenique       { !\tete !\carboxyle !\trilinolenique }
% version trans !\lhb !\lhb !\lhb !\trans !\trans !\trans !\lh
\definesubmol\oleique           { !\tete !\carboxyle !\trioleique }
\definesubmol\linoleique        { !\tete !\carboxyle !\trilinoleique }
\definesubmol\arachidonique     { !\tete !\carboxyle !\triarachidonique }
\definesubmol\eicosaPentaenoique{ !\tete !\carboxyle !\trieicosapenta }
\definesubmol\docosaHexanoique  { !\tete !\carboxyle !\tridocosahexa }
%% Formes semi-développées
\definesubmol\oleiqueSemiDev  { C_{17} H_{33} -C !\carboxyleDev }
\definesubmol\oleateSemiDev   { C_{17} H_{33} -C (!\lldh O) (!\ldb \phantom{'}O^{-}) }
\definesubmol\steraiqueSemiDev{ C_{17} H_{35} -C !\carboxyleDev }
\definesubmol\caproiqueSemiDev{ CH_2 - CH_2 - CH_2 - CH_2 - CH_2 - C !\carboxyleDev }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Lipide topo
\definesubmol\oleine{
  !\triester{!\trioleique} {!\trioleique} {!\trioleique} 
}
\definesubmol\palmitine{ 
  !\triesterSat{!\lb !\tripalmitique} {!\tripalmitique !\lb} !\lb !\tripalmitique 
}
\definesubmol\arachidonine{
  !\triester{!\triarachidonique} {!\triarachidonique} {!\triarachidonique} 
}
\definesubmol\phosphatidylcholine{
  % choline
  -[::-30] \charge{90:4pt=$+$}{N} (-[::-30])(-[::-90]) !\lhb
  % phosphate 
  !\lh O !\lb P  (=[::-20] O)(-[::-100] \charge{140:2pt=$-$}{O}) !\lh
  % diglycéride
  !\glycero{!\lb !\carbonyle !\trioleique} !\lb (!\llb O) !\trilaurique
}
% Lipide semi-dev
\definesubmol\oleineSemiDev{
  !\triesterDev {!\trioleiqueSemiDev} {!\trioleiqueSemiDev} !\trioleiqueSemiDev
}
\definesubmol\caproineSemiDev{
  !\triesterDev {!\tricaproiqueSemiDev} {!\tricaproiqueSemiDev} !\tricaproiqueSemiDev
}
\definesubmol\palmitineSemiDev{
  !\triesterDev {!\tripalmitiqueSemiDev} {!\tripalmitiqueSemiDev} !\tripalmitiqueSemiDev
}

%% glycérol
\definesubmol\glycerol{[:30] H !\glycero{H} H }
\definesubmol\glycerolSemiDev{
  HC (-OH)
  (-[::90,,2,2] H_2C (-OH))
  -[::-90,,2,2] H_2C (-OH)
}
\definesubmol\glycerolSemiDevHorizontal{
  H_2C (-[::90,,2,2] HO) 
  -[::0,1.2] !\CH (-[::90] \chemabove{O}{H})
  -[::0,1.2] CH_2 (-[::90] OH)
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Stérols
\definesubmol\sterol6{
  *6(#1 % 1er cycle
    *6(#2 % 2ème cycle
      *6(- % 3ème cycle
        *5(-- #3) % 4ème cycle
        #4) % 3
      #5) % 2
    #6) % 1
}
\definesubmol\cholesterol{
  HO-[:30] !\sterol {--} {=--} {
    -(-[::-35] (!\lh) !\lb !\lb !\lhb (!\lb) !\lh) -
  } {- (-[::0]) ---} {---} {- (-[::0]) ---}
}
% Glucocorticoïdes
\definesubmol\cortisol{
  O=[:30] !\sterol {-=} {---} {
    -(-[::-100] OH) (-[::-35] (!\llh O) !\lb!\lh OH) -
  }{
    -(-[::0]) -- (-HO) -
  } {--} {- (-[::0]) ---}
}
\definesubmol\corticosterone{
  O=[:30] !\sterol {-=} {---} {
    - (-(!\llh O) !\lb!\lh OH) -
  }{
    -(-[::0] !\llh O) -- (-HO) -
  } {--} {- (-[::0]) ---}
}
% Minéralocorticoïdes
\definesubmol\aldosterone{
  O=[:30] !\sterol {-=} {---} {
    - (-(!\llh O) !\lb!\lh OH) -
  }{
    -(-[::0]) -- (-HO) -
  } {--} {- (-[::0]) ---}
}
% Oestrogènes
\definesubmol\estrone{
  HO-[:30] !\sterol {-=} {---} {-(=O)-} {- (-[::0]) ---} {--} {-=-=}
}
\definesubmol\estriol{
  HO-[:30] !\sterol {-=} {---} {(-OH)-(-OH)-} {- (-[::0]) ---} {--} {-=-=}
}
\definesubmol\estradiol{
  HO-[:30] !\sterol {-=} {---} {-(-OH)-} {- (-[::0]) ---} {--} {-=-=}
}
% Androgènes
\definesubmol\testosterone{
  O=[:30] !\sterol {-=} {---} {-(-OH)-} {- (-[::0]) ---} {---} {- (-[::0]) ---}
}
\definesubmol\dihydrotestosterone{
  O=[:30] !\sterol {--} {---} {-(-OH)-} {- (-[::0]) ---} {---} {- (-[::0]) ---}
}
\definesubmol\androstenedione{
  O=[:30] !\sterol {-=} {---} {-(=O)-} {- (-[::0]) ---} {---} {- (-[::0]) ---}
}
\definesubmol\DHEA{
  O=[:30] !\sterol {--} {=--} {-(=O)-} {- (-[::0]) ---} {---} {- (-[::0]) ---}
}
\definesubmol\DHEAS{
  HO-[:30] S (=[::20] O) (=[::100] O) !\lb O !\lh 
  !\sterol {--} {=--} {-(=O)-} {- (-[::0]) ---} {---} {- (-[::0]) ---}
}
% Progestatif
\definesubmol\progesterone{
  O=[:30] !\sterol {-=} {---} {-(- (!\lh) !\llb O)-} {- (-[::0]) ---} {--} {- (-[::0]) ---}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%------ Glucides
%% Pour la représentation de Haworth du glucose ou du fructose
\definesubmol\hexaOseHaw1{
  !\vide{:90,0.01} % Pour avoir la bonne orientation
  %% Bas du cycle
  <[::-140,0.9] (-[::140,0.7] OH) 
  -[::50,1.1,,,line width=3pt] (-[::-90,0.7] OH)
  >[::45,0.9]
  %% haut du cycle
  -[::90,0.9]O -[::45] (#1) -[::40,0.9]
  %% pour retourner sur la droite du cycle
  !\vide{::180,0.9} !\vide{::-40} !\vide{::-45,0.9}
}
\definesubmol\pentaOseHaw2{
  !\vide{:-90,0.01} % Pour avoir la bonne orientation
  ? <[::30] (#1) -[::60,1.3,,,line width= 3pt] (#2) >[::60] -[::90,1.35]O ?
  % on repart à l'envers de l'oxygène pour pouvoir ajouter une chaîne à gauche
  !\vide{::180,1.35}
}
\definesubmol\CHHOH{ -[::-90,0.5] -[::60,0.7,,2] HO }
\definesubmol\gluHaw{ !\hexaOseHaw{!\CHHOH} }
\definesubmol\polymere{ \cdots }

%------ Amidon
\definesubmol\amylopectineHaw{
  !\polymere - !\gluHaw -O-
  !\hexaOseHaw{-[::-90,0.8] !\lh O -[::-60,1.2] !\gluHaw -O- !\gluHaw -!\polymere}
  -O- !\gluHaw -!\polymere
}

%% Pour faciliter l'écriture d'un sucre en formule développée
\definesubmol{\ose} { -[::0] C (-[::-90] H) (-[::90] OH) }

%% glucose
\definesubmol\glucoseHaw{
  HO -[::90,0.9,2] !\gluHaw -[::135,0.7,,1] OH
}
\definesubmol\glucoseCycle{
  HO -[::30] *6 (-(-OH) -(-OH) -(-OH) -O- (- !\lb OH)-)
}
\definesubmol\glucose{
  H -[::30] (!\llh O) !\lb (!\lb OH) !\lh (!\lh OH) !\lb (!\lb OH) !\lh (!\lh OH) !\lbh OH
}
\definesubmol\glucoseSemiDev{
  C (-[::120] H) (=[::-120] O) !\ose !\ose !\ose !\ose !\ose (-[::0] H)
}

%% galactose
\definesubmol\galactoseHaw{
  !\vide{::90,0.95} % alignement vertical
  (-[::0,0.9,,2] HO) !\gluHaw -[::135,0.7,,1] OH
}

%% fructose
\definesubmol\fructoseHaw{
  HO -[::90,0.9,2] !\hexaOseHaw{} (-[::135,0.7,,1] OH) -[::-45,0.7] -[::60,0.7,,1] OH
}
\definesubmol\fructofuranoseHaw{
  !\vide{:90,2} % alignement vertical
  HO -[::-120,0.7] -[::-60,0.8]
  !\pentaOseHaw{-[::-30,0.7,,2] HO}{-[::90,0.8,,2] HO\phantom{I}}
  (-[::120,0.7] OH) -[::-60,0.7] -[::60,0.7,,1] OH
}
\definesubmol\fructoseCycle{
  HO -[::30] *6 (-(-OH) -(-OH) -(-[::0] OH) (-[::-90] !\lh OH) -O--)
}
\definesubmol\fructose{
  HO -[::30] !\lb (!\llb O) !\lh (!\lh OH) !\lb (!\lb OH) !\lh (!\lh OH) !\lbh OH
}
\definesubmol\fructoseSemiDev{
  OH -[::0]  C!\HH -[::0] C (=[::90] O) !\ose !\ose !\ose !\ose (-[::0] H)
}

%% Saccharose
\definesubmol\saccharoseHaw{
  % glucose
  HO -[::90,0.9,2] !\gluHaw -[::20] O -[::50] 
  % fructose
  (-[::70,0.5] -[::60,0.7,,2] HO)
  !\pentaOseHaw{-[::-30,0.7,,2] HO}{-[::90,0.8,,2] HO\phantom{I}}
  -[::-60,0.7] -[::60,0.7,,1] OH
}

%------ Ribose
\definesubmol\ribose{
  % liaison à droite et cycle
  -[::-30] !\lb *5([::70]- (-HO) -(-OH) --O-)
  % imite les angles du cycle pour pouvoir ajouter une chaîne à gauche
  !\vide{::124} !\vide{::-72} -[::128]
}
\definesubmol\riboseHaw{
  -[::-30] !\lb !\pentaOseHaw{!\lb HO}{!\lb OH} -[::120]
}
\definesubmol\desoxyribose{
  % liaison à droite et cycle
  -[::-30] !\lb *5([::70]- (-HO) ---O-)
  % imite les angles du cycle pour pouvoir ajouter une chaîne à gauche
  !\vide{::124} !\vide{::-72} -[::128]
}
\definesubmol\desoxyriboseHaw{
  -[::-30] !\lb !\pentaOseHaw{!\lb HO}{} -[::120]
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%------ Base nucléique
\definesubmol\adenine { *5(- *6(-N=-N= (-[,,,1]NH_2) -) =-N=-) }
\definesubmol\guanine { *5(- *6(-N= (-[,,,1]NH_2) -[,,,1] NH -[,,1] (=O)-) =-N=-) }
\definesubmol\thymine { *6(- (=O) -[,,,1] NH -[,,1] (=O) -(-)=-) }
\definesubmol\uracile { *6(- (=O) -[,,,1] NH -[,,1] (=O) -=-) }
\definesubmol\cytosine{ *6(- (=O) -N= (-[,,,1]NH_2) -=-) }

%------ Ribonucléoside
\definesubmol\adenosine{ !\ribose N !\adenine }
\definesubmol\cytidine { !\ribose N !\cytosine }
\definesubmol\guanosine{ !\ribose N !\guanine }
\definesubmol\thymidine{ !\ribose N !\thymine }
\definesubmol\uridine  { !\ribose N !\uracile }
%%
\definesubmol\adenosineHaw{ !\riboseHaw N !\adenine }
\definesubmol\cytidineHaw { !\riboseHaw N !\cytosine }
\definesubmol\guanosineHaw{ !\riboseHaw N !\guanine }
\definesubmol\thymidineHaw{ !\riboseHaw N !\thymine }
\definesubmol\uridineHaw  { !\riboseHaw N !\uracile }

%------ Desoxyribonucléoside
\definesubmol\desoxyAdenosine{ !\desoxyribose N !\adenine }
\definesubmol\desoxyCytidine { !\desoxyribose N !\cytosine }
\definesubmol\desoxyGuanosine{ !\desoxyribose N !\guanine }
\definesubmol\desoxyThymidine{ !\desoxyribose N !\thymine }
\definesubmol\desoxyUridine  { !\desoxyribose N !\uracile }
%%
\definesubmol\desoxyAdenosineHaw{ !\desoxyriboseHaw N !\adenine }
\definesubmol\desoxyCytidineHaw { !\desoxyriboseHaw N !\cytosine }
\definesubmol\desoxyGuanosineHaw{ !\desoxyriboseHaw N !\guanine }
\definesubmol\desoxyThymidineHaw{ !\desoxyriboseHaw N !\thymine }
\definesubmol\desoxyUridineHaw  { !\desoxyriboseHaw N !\uracile }

%------ Adenosine Tri-Phosphate et Adenosine Di-Phosphate
\definesubmol\tetePhosphate{ \charge{45:1.5pt=$\scriptstyle -$}{O} -!\phosphate }
\definesubmol\ADP{ !\tetePhosphate -!\phosphate !\adenosine }
\definesubmol\ATP{ !\tetePhosphate -!\phosphate -!\phosphate !\adenosine}
\definesubmol\ADPHaw{ !\tetePhosphate -!\phosphate !\adenosineHaw }
\definesubmol\ATPHaw{ !\tetePhosphate -!\phosphate -!\phosphate !\adenosineHaw}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Acides alpha aminés, formules topologiques
\definesubmol\acideAmine1{ H_2N -[::30] (#1) !\lb !\carboxyle }
\definesubmol\arginine      { !\acideAmine{!\lh!\lhb!\lh HN -[::-60,,2] (!\lb NH_2) !\llh HN} }
\definesubmol\histidine     { !\acideAmine{!\lh!\lh *5(-N=-HN-=)} }
\definesubmol\lysine        { !\acideAmine{!\lh!\lhb!\lhb NH_3^{+}} }
\definesubmol\aspartique    { !\acideAmine{!\lh!\lh !\carbonyle O^{-}} }
\definesubmol\glutamique    { !\acideAmine{!\lh!\lhb !\carbonyle O^{-}} }
\definesubmol\serine        { !\acideAmine{!\lh!\lh HO} }
\definesubmol\threonine     { !\acideAmine{!\lh (!\lh HO) !\lb} }
\definesubmol\asparagine    { !\acideAmine{!\lh!\lh (!\llb O) !\lh H_2N} }
\definesubmol\glutamine     { !\acideAmine{!\lh!\lhb (!\llb O) !\lh NH_2} }
\definesubmol\cysteine      { !\acideAmine{!\lh!\lh HS} }
\definesubmol\selenocysteine{ !\acideAmine{!\lh!\lh HSe} }
\definesubmol\glycine       { !\acideAmine{} }
\definesubmol\proline       { !\vide{:90} !\vide{:6,0.01} *5(-\!\NH- (- !\carboxyle) ---) }
\definesubmol\alanine       { !\acideAmine{!\lh} }
\definesubmol\valine        { !\acideAmine{!\lh (!\lb) !\lh} }
\definesubmol\isoleucine    { !\acideAmine{!\lh (!\lb) !\lhb} }
\definesubmol\leucine       { !\acideAmine{!\lh!\lh (!\lb) !\lh} }
\definesubmol\methionine    { !\acideAmine{!\lh!\lh!\lb S !\lh} }
\definesubmol\phenylalanine { !\acideAmine{!\lh!\lh *6(=-=-=-)} }
\definesubmol\tyrosine      { !\acideAmine{!\lh!\lh *6(=-=(-OH)-=-)} }
\definesubmol\tryptophane   { !\acideAmine{!\lh!\lh *5(- *6(-=-=-) =-HN-=)} }
%% Acides alpha aminés, formules semi-developpée
\definesubmol\acideAmineSD{ CH (-[::-90] NH_2) -C !\carboxyleDev }
\definesubmol\alanineSemiDev   { H_3C- !\acideAmineSD }
\definesubmol\asparagineSemiDev{ C (=[::-120] O) (-[::120] H_2N) -CH_2 -CH_2 - !\acideAmineSD }
\definesubmol\glycineSemiDev   { H_2C (-[::-90,,2] NH_2) -C !\carboxyleDev }
\definesubmol\cysteineSemiDev  { HS -CH_2 - !\acideAmineSD }
\definesubmol\valineSemiDev    { HC (-[::90,,2,2] H_3C) (-[::-90,,2,2] H_3C) - !\acideAmineSD }
\definesubmol\isoleucineSemiDev{ HC (-[::90,,2] CH_2 -[::90] H_3C) (-[::-90,,2,2] H_3C) - !\acideAmineSD }
%% Acides alpha aminés, représentation de fischer gauche (FL) ou droite (FD)
\definesubmol\acideAmineFL{COOH-[::0] (-[::-90] NH_2) (-[::90] H) -[::0]}
\definesubmol\acideAmineFD{COOH-[::0] (-[::90] NH_2) (-[::-90] H) -[::0]}
\definesubmol\alanineL {[:-90] !\acideAmineFL CH_3}
\definesubmol\alanineD {[:-90] !\acideAmineFD CH_3}
\definesubmol\valineL  {[:-90] !\acideAmineFL !\branche{H_3C}{H} -[::0] CH_3}
\definesubmol\valineD  {[:-90] !\acideAmineFD !\branche{H_3C}{H} -[::0] CH_3}

%% Pour faire des polypeptides en formule topologique H = haut, B = bas
\definesubmol\acideAmineH1{ !\lh (#1) !\lb (!\llb O) !\lh }
\definesubmol\acideAmineB1{ !\lb (#1) !\lh (!\llh O) !\lb }
\definesubmol\arginineH      { !\acideAmineH{!\lh!\lhb!\lh HN -[::-60,,2] (!\lb NH_2) !\llh HN} }
\definesubmol\arginineB      { !\acideAmineB{!\lb!\lbh!\lb HN -[::60,,2]  (!\lh H_2N) !\llb NH} }
\definesubmol\histidineH     { !\acideAmineH{-[::70]-[::-45] *5(-N=-\!\HN-=)} }
\definesubmol\histidineB     { !\acideAmineB{-[::-70]-[::45] *5(-N=-NH-=)} }
\definesubmol\lysineH        { !\acideAmineH{!\lh!\lhb!\lhb NH_3^{+}} }
\definesubmol\lysineB        { !\acideAmineB{!\lb!\lbh!\lbh H_3N^{+}} }
\definesubmol\aspartiqueH    { !\acideAmineH{!\lh!\lb !\carbonyle O^{-}} }
\definesubmol\aspartiqueB    { !\acideAmineB{!\lb!\lh !\carbonyle O^{-}} }
\definesubmol\glutamiqueH    { !\acideAmineH{!\lh!\lhb !\carbonyle O^{-}} }
\definesubmol\glutamiqueB    { !\acideAmineB{!\lb!\lbh !\carbonyle O^{-}} }
\definesubmol\serineH        { !\acideAmineH{!\lh!\lb HO} }
\definesubmol\serineB        { !\acideAmineB{!\lb!\lh OH} }
\definesubmol\threonineH     { !\acideAmineH{!\lh (!\lb HO) !\lh} }
\definesubmol\threonineB     { !\acideAmineB{!\lb (!\lh OH) !\lb} }
\definesubmol\asparagineH    { !\acideAmineH{!\lh!\lb (!\llb O) !\lh NH_2} }
\definesubmol\asparagineB    { !\acideAmineB{!\lb!\lh (!\llh O) !\lb NH_2} }
\definesubmol\glutamineH     { !\acideAmineH{!\lh!\lhb (!\llh O) !\lb H_2N} }
\definesubmol\glutamineB     { !\acideAmineB{!\lb!\lbh (!\llb O) !\lh H_2N} }
\definesubmol\cysteineH      { !\acideAmineH{!\lh!\lb HS} }
\definesubmol\cysteineB      { !\acideAmineB{!\lb!\lh SH} }
\definesubmol\selenocysteineH{ !\acideAmineH{!\lh!\lb HSe} }
\definesubmol\selenocysteineB{ !\acideAmineB{!\lb!\lh SeH} }
\definesubmol\glycineH       { !\acideAmineH{} }
\definesubmol\glycineB       { !\acideAmineB{} }
\definesubmol\prolineH       { *5(-----) !\vide{::54}  !\lh (!\llh O) !\lb}
\definesubmol\prolineB       { *5(-----) !\vide{::-54} !\lb (!\llb O) !\lh}
\definesubmol\alanineH       { !\acideAmineH{!\lh} }
\definesubmol\alanineB       { !\acideAmineB{!\lb} }
\definesubmol\valineH        { !\acideAmineH{!\lh (!\lb) !\lh} }
\definesubmol\valineB        { !\acideAmineB{!\lb (!\lb) !\lh} }
\definesubmol\isoleucineH    { !\acideAmineH{!\lh (!\lb) !\lbh} }
\definesubmol\isoleucineB    { !\acideAmineB{!\lb (!\lb) !\lhb} }
\definesubmol\leucineH       { !\acideAmineH{!\lh!\lb (!\lb) !\lh} }
\definesubmol\leucineB       { !\acideAmineB{!\lb!\lh (!\lb) !\lh} }
\definesubmol\methionineH    { !\acideAmineH{!\lh!\lb!\lh S !\lb} }
\definesubmol\methionineB    { !\acideAmineB{!\lb!\lh!\lb S !\lh} }
\definesubmol\phenylalanineH { !\acideAmineH{!\lh!\lb *6(=-=-=-)} }
\definesubmol\phenylalanineB { !\acideAmineB{!\lb!\lh *6(=-=-=-)} }
\definesubmol\tyrosineH      { !\acideAmineH{-[::70]-[::-45] *6(=-=(-OH)-=-)} }
\definesubmol\tyrosineB      { !\acideAmineB{-[::-70]-[::45] *6(=-=(-HO)-=-)} }
\definesubmol\tryptophaneH   { !\acideAmineH{-[::70]-[::-45] *5(- *6(-=-=-) =-\!\HN-=)} }
\definesubmol\tryptophaneB   { !\acideAmineB{-[::-70]-[::45] *5(- *6(-=-=-) =-NH-=)} }
%% Pour faire des polypeptides en formule semi-développée
%% SD = semi-dev ; H = haut ; B = bas
\definesubmol\acideAmineSDH1{-CH (#1) -C (=[::-90] O)-}
\definesubmol\acideAmineSDB1{-CH (#1) -C (=[::90] O)-}
\definesubmol\cysteineSemiDevH  { !\acideAmineSDH{-[::90]  CH_2 -[::0] HS } }
\definesubmol\cysteineSemiDevB  { !\acideAmineSDB{-[::-90] CH_2 -[::0] HS } }
\definesubmol\glycineSemiDevH   { -CH_2 -C (=[::-90] O)- }
\definesubmol\glycineSemiDevB   { -CH_2 -C (=[::90] O)- }
\definesubmol\alanineSemiDevH   { !\acideAmineSDH{-[::90]  CH_3} }
\definesubmol\alanineSemiDevB   { !\acideAmineSDB{-[::-90] CH_3} }
\definesubmol\isoleucineSemiDevH{ !\acideAmineSDH{-[::90]  CH (!\ldh H_2C -[::-50,,2,2]H_3C) !\ldb CH_3 } }
\definesubmol\isoleucineSemiDevB{ !\acideAmineSDB{-[::-90] CH (!\ldh CH_2 !\ldb CH_3) !\ldb H_3C } }
\definesubmol\valineSemiDevH    { !\acideAmineSDH{-[::90]  CH (!\ldh H_3C) !\ldb CH_3} }
\definesubmol\valineSemiDevB    { !\acideAmineSDB{-[::-90] CH (!\ldb H_3C) !\ldh CH_3} }

%------ Heme
\definesubmol\hemeB {
  [:-60] !\llb
  !\pyrrole{-N (!\ldb) --(-!\lhb (!\llh O) !\lb HO) =(-) -} % bas droite
  !\llh !\lb
  !\pyrrole{=N (-[::-50,0.9,,,dotted]) --(-) =(-!\lhb (!\llh O) !\lb HO) -} % bas gauche
  !\llh !\lb 
  !\pyrrole{-N (-[::-50,1.4]Fe^{2+}) -=(-!\llh) -(-) =} % haut gauche
  !\lh !\llb 
  !\pyrrole{-N (-[::-50,0.9,,,dotted]) =-(-!\llh) =(-) -} % haut droite
  !\lh
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Hormones
\definesubmol\creatinine{
  O= *5(-N (-[-3,0.5]H) -(=NH) -N (-) --)
}
\definesubmol\DOPA{
  HO -[:30] *6(= (-OH) -= (-!\lb (!\lb NH_2) !\lh!\carboxyle) -=-)
}
\definesubmol\DOPAH{
  HO -[:30] *6(= (-OH) -= (-!\lb (!\lb NH_3^+) !\lh!\carboxyle) -=-)
}
\definesubmol\prostaglandine{
  HO-[::75] *5(
    - (-!\llh !\lb (!\lb HO) !\lhb !\lhb !\lh)
    - (-[::-65] !\lbh !\lbh !\lbh !\carboxyle)
    - (=O)
    --
  )
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Produit de contraste
\definesubmol\chelate{-[::-70] -[::80] -[::80]} 
\definesubmol\chelateCOO{-[::-120] !\lb (!\llb O) !\lh O^{-}}
\definesubmol\ionChelate{
  [:-10] N (!\vide{::70, 0.7} Gd^{3+})
    (!\chelateCOO) !\chelate
  N (!\chelateCOO) !\chelate
  N (!\chelateCOO) !\chelate 
  N (!\chelateCOO) -[::-70] -[::80] -[::80,0.75]
}
\definesubmol\chelateAlcool{
  [:-10] N (!\vide{::70, 0.7} Gd^{3+})
    (!\chelateCOO) !\chelate
  N (!\chelateCOO) !\chelate
  N (-[::-120] !\lb (!\lb) !\lh OH) !\chelate 
  N (!\chelateCOO) -[::-70] -[::80] -[::80,0.75]
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Vitamines
\definesubmol\cret{ !\llb !\lh }
\definesubmol\retinol{ % Vitamine A
  *6( % cycle
    --(-[::0]) (-[::-80]) = ( % chaine
      !\lb !\cret (!\lh) !\cret !\cret (!\lh) !\cret !\lb OH
    ) % chaine
    -(-)--
  ) % cycle
}
\definesubmol\acideAscorbique{ % Vitamine C
  HO-[::-30] !\lh (!\lh OH) !\lb *5(-(-HO) =(-OH) -(=O) -O-)
}
\definesubmol\cholecarciferol{ % Vitamine D
  HO-[::-30]
  *6( % 1er cycle
    ---(=)- ( % ramification
      = !\lb !\llh *6(- % 2eme
        *5(
          --- (-(!\lh) !\lb !\lhb !\lh(!\lh) !\lb) --
        ) % 3eme
        -(-[::0])----
      ) % 2eme
    ) % ramification
    --
  ) % 1er
}
% vitamine B1 thiamine
\definesubmol\thiamine{
  -[::30]  *6(
    -N=- (
      - !\lb N  *5(-(-)= (- !\lh !\lb OH) -S-=) % 2nd cycle
    )
    = (-NH_2) -N=
  ) % 1er cycle
}
% vitamine B2 riboflavine
\definesubmol\riboflavine{
  -[::30]  *6(
    =- ( *6(
        - N ( !\lbh (!\lh OH) !\lb (!\lb OH) !\lh (!\lh OH) !\lb !\lh OH )
      - ( *6(=N- (=O) -NH- (= O)-) )
      -=N-
    ))
    =-= (-) -
  )
}
% vitamine B3 acide nicotinique
\definesubmol\acideNicotinique{
   *6(-N=- (- (!\llh O) !\lb OH) =-=)
}
\definesubmol\nicotinamide{
   *6(-N=- (- (!\llh O) !\lb NH_2) =-=)
}
% vitamine B5 acide panthotenique
\definesubmol\acidePantothenique{
  HO -[::30] !\lb (-[::-90]) (-[::-30])
  !\lh ( !\lh OH )
  !\lb (!\llb O )
  !\lh \!\HN !\lbh !\lb (!\llb O)
  !\lh OH
}
% vitamine B6 pyroxidine
\definesubmol\pyroxidine{
  HO -[::30] !\lb  *6(=-N= (-)- (-OH)= (!\lb OH) -)
}
% vitamine B8 biotine
\definesubmol\biotine{
  \!\NH *5(
    - *5(--S- (- !\lbh !\lb) -)
    --\!\HN- (= HO) -
  )
}
% vitamine B9 acide folique
\definesubmol\acideFolique{
  H_2N -[::30]  *6(
    =N- *6(
      -N=- (
        - !\lb \!\NH !\lh  *6(
          =-= (
            - (!\llh O)
            !\lb \!\NH !\lh (!\lh (!\lh HO) !\llb O)
            !\lb !\lbh (!\lh OH) !\llb O
          )
          -=-
        ) % 3eme cycle
      )
      =N-
    ) % 2nd cycle
    =- (=O) =N-
  ) % 1er cycle
}
% vitamine B12 cyanocobalamine
\definesubmol\pyrrole1{ *5(#1) !\vide{::-54} !\vide{::72} !\vide{::-108,0.01} }
\definesubmol\propanamide[!\lb!\lbh (!\lh H_2N) !\llb O ]{ !\lb!\lbh (!\lh NH_2) !\llb O}
\definesubmol\ethanamide[!\lb!\lb (!\lh H_2N) !\llb O ]{ !\lb!\lb (!\lb NH_2) !\llh O}
\definesubmol\cyanocobalamine{
  [:-60] !\llb
  !\pyrrole{ % bas droite
    -N (-[::-50,0.9,,,->]) =-(!\ldb !\ldh !\ldh (!\lb NH_2) !\llh O) -(-[::-30])(-[::-90]) -
  }
  !\lh (!\lh) !\llb 
  !\pyrrole{ % bas gauche
    -N (-[::-50,1.4]Co^{+} -[::45,,1,1] CN) 
    --(!\ethanamide) -(
      -[::-100] !\lhb (!\llb O) !\lh NH -[::-60,,1] !\lh (!\lb) 
      !\lh O -[::0] !\phosphate !\ldh *5( % cycle du bas ether
        - (-!\lh OH) -O- (-N *5(- *6(=-(-)=(-)-=)
        --N (-[::-39,4.5,,,dotted]) =-)) % Cycle du bas amidine
      -(-HO)-)
    ) (-[::0]) -
  }
  -[::28] -[::0,0.68] !\vide{::-28,0.01} (-[::150]) % longue liaison à gauche
  !\pyrrole{ % haut gauche
    -N (-[::-60,0.9,,,->]) =-(!\propanamide) -(!\ethanamide)(-[::0]) -
  }
  !\lh (!\lh)  !\llb 
  !\pyrrole{ % haut droite
    -N (-[::-50,0.9,,,->]) =-(!\propanamide) -(!\ethanamide)(-[::0]) -
  }
  !\lh
}
% vitamine E
\definesubmol\isoprene{!\llh (!\lh) !\lb}
\definesubmol\phytyle{!\lbh (!\lh) !\lb}
\definesubmol\tocopherol{ % alpha
  -[::30]  *6(
    = (-) -  *6(-O- (
        -!\lh !\phytyle !\lh !\phytyle !\lh !\phytyle
      ) (-[::0]) ---
    ) % 2nd cycle
    =- (-) = (-HO) -
  ) % 1er cycle
}
\definesubmol\tocotrienol{ % alpha
  -[::30]  *6(
    = (-) -  *6(-O- (
        -!\lhb !\isoprene !\lhb !\isoprene !\lhb !\isoprene
      ) (-[::0]) ---
    ) % 2nd cycle
    =- (-) = (-HO) -
  ) % 1er cycle
}
% vitamine K1
\definesubmol\menatetrenone{
  *6(-= 
    *6(- (=O)- (-)= (
      - !\lb !\isoprene !\lhb !\isoprene !\lhb !\isoprene !\lhb !\isoprene
    )- (=O) -)
  -=-=)
}
\definesubmol\phylloquinone{
  *6(-= 
    *6(- (=O)- (-)= (
      - !\lb !\isoprene !\lh !\phytyle !\lh !\phytyle !\lh !\phytyle
    )- (=O) -)
  -=-=)
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Aspirine
\definesubmol\aspirineSemiDev{
  HC *6( % cycle
    -\CH =CH -C (
      -O !\lb C (!\llb O) !\lh CH_3 % chaine latérale
    )
    =C (-C !\carboxyle) -[,,,2]HC =[,,2]
  ) % cyle
}
\definesubmol\aspirine{
  *6 (-=- (-O !\lb (!\llb O) !\lh) = (-!\carboxyle) -=)
}
\definesubmol\acideSalicylique{
  *6 (-=- (-OH) = (-!\carboxyle) -=)
}

%% Paracétamol
\definesubmol\paracetamol{
  HO -[::30] *6(
    -=- (
      -\!\HN (!\lb (!\llb O) !\lh) % amide
    )
    =-=
  )
}
\definesubmol\paracetamolSemiDev{
  HO -[::30] C *6(
    -\CH =CH -C (
      -\!\HN (!\lb C (!\llb O) -CH_3) % amide
    )
    =\HC -HC =[,,2]
  )
}
\definesubmol\paracetamolDev{
  H -[::0] O -[::30] C *6(
    -C (-H) =C (-H) -C (
      -N (!\lh H) (!\lb C (!\llb O) (-C !\HHH)) % amide
    )
    =C (-H) -C (-H) =
  )
}

%% Aspartame
\definesubmol\aspartame{
  HO -[::90,,2] (!\llh O) !\lb!\lb (!\lb NH_2) % chaine latérale
  !\lh (!\llh O) !\lb \!\NH !\lh % amide
  *6(- (=O) -O (-) !\vide{} *6(-=-=-) =--) % double cycle
}
\definesubmol\aspartameCompact{
  HO -[::-30,] (!\llh O) !\lb!\lh (!\lb NH_2) % chaine latérale
  !\lh (!\llh O) !\lb \!\NH !\lh % amide
  *6(- (=O) -O (-) !\vide{} *6(-=-=-) =--) % double cycle
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%------ Molécules odorantes
\definesubmol\geraniol{
  -[::30] (!\lb) !\llh *6( % pied
    !\vide{} !\vide{} (- !\lb OH) % chaine latérale
    =(-)--- %fin du cycle
  )
}
\definesubmol\geraniolSemiDev{
  H_3C - C (- CH_3) =[::90] CH % pied
  !\lh H_2C -[::-60,,2,2] H_2C !\lb C % "cycle"
  (!\lh CH_3) !\llb !\CH -[::30] CH_2 -OH % chaînes latérales
}
\definesubmol\vanilline{
  HO -[::90,,2] *6(= (-O !\lh) -= (- !\carbonyle H) -=-)
}
\definesubmol\ethylvanilline{
  HO -[::90,,2] *6(= (-O !\lhb) -= (- !\carbonyle H) -=-)
}
\definesubmol\oxyphenylone{
  HO -[::30] *6(-=- (-!\lbh (!\llh O) !\lb) =-=)
}
\definesubmol\limonene{ 
  -[:30] (!\llb) !\lh *6(--=(-)---)
}
\definesubmol\limoneneSemiDev{
  H_3C -[:30] C (!\llb CH_3) !\lh \HC 
  *6(-CH_2 -CH =C (-CH_3) -[,,,2]H_2C -[,,2,2]H_2C -)
}
\definesubmol\acetateIsoamyle{
  -[:30] (!\lh) !\lbh !\lb O !\lh (!\llh O) !\lb
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%------ Drogues
\definesubmol\THC{
  -[::30] *6( % cyle ether
    (-[::120]) -O- *6( % cycle chaine latérale et alcool
      -= (!\lbh !\lbh !\lb) -= (-OH) -
    )
    =- *6(-=(-)---) -- % cycle supérieur
  )
}
\definesubmol\cocaineHaw{
  ? 
    <[::60,0.7] (!\lh N !\lh)
    -[::-60,,,,line width = 3pt]
    >[::-30,0.7] ( % ether-phenyl
      !\lh O !\lb (!\llb O) !\lh *6(=-=-=-)
    )
    -[::130,0.7] ( % ester
      !\ldb (!\llh O)
      !\lb O !\lh 
    )
    -[::80, 0.9] (-[::-30, 0.85]) -[::60, 0.7] 
  ?
}
\definesubmol\bisphenolA{
  HO-[:30] *6(-=- (- (-[::0]) (-[::120]) !\lb *6(-=- (-OH) =-=)) =-=)
}
\definesubmol\bisphenolASemiDev{
  HO-[:30] C *6(-\CH =CH -[,,,1]C (
    -C (-[::25] CH_3) (-[::95] H_3C) !\lb C 
      *6(-[,,,2]HC =\CH -C (-OH) =CH -[,,,1]\HC =C)
  ) =\HC -HC =[,,2])
}

%------ Eumélanine
\definesubmol\iminoique{*5(-!\NH - (-!\carboxyle) =-)}
\definesubmol\eumelanine{
  O *6(=(-OH) - (!\iminoique) =- (
    - *6(- (!\iminoique) =- (
      - *6(= (!\iminoique) -=(-...) -(=O) -(=O) -)
    ) =(-HO) -(-HO) =)
  ) =O)
}
