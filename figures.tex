%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% figures simples
\newcommand{\tkzRect}[4]{
  \fill[color=#1] (#2,#4) -- (-#2,#4) -- (-#2,#3) -- (#2,#3);
}
\newcommand{\tkzEllipse}[4]{
  \fill[color=#1] (0,#3) ellipse (#2 and #4);
}

\newcommand{\tkzCercle}[4]{
  \filldraw [#3] (#1, #2) circle (#4pt);
}
\newcommand{\tkzCercleLigne}[5]{
  \filldraw [color = #4, fill = #3, very thick] (#1, #2) circle (#5pt);
}

%%%% tube à essais
\newcommand{\tkzTubeEssai}[3]{
  \draw[thick] (#1,#2) -- (#1,0) arc (0:-180:#1) -- (-#1,#2);
  \draw[thick] (0,#2) ellipse (#1 and #3);
}
\newcommand{\tkzBasTubeEssai}[5]{
  \fill[color=#1] (-#2,#3) -- (#2,#3) arc (0:-180:#2);
  \tkzRect{#1}{#2}{#3 - 0.01}{#4}
  \tkzEllipse{#1!85!black}{#2}{#4}{#5}
}
\newcommand{\tkzPhaseTubeEssai}[5]{
  \tkzRect{#1}{#2}{#3}{#4}
  \tkzEllipse{#1}{#2}{#3}{#5}
  \tkzEllipse{#1!85!black}{#2}{#4}{#5}
}

%%%% Point et vecteurs
\newcommand{\tkzLabel}[3]{
  \node at (#1, #2) {#3};
}
\newcommand{\tkzPointLabel}[3]{
  \filldraw (#1, #2) circle (2pt) node[above] {#3};
}
% \tkzVecteur [couleur] (x) [longueur x] (y) [longueur y] {legende} [position legende] 
% ajouter une * à la fin transforme la flèche en double flèche <->
\NewDocumentCommand{\tkzVecteur}{O{black} r() O{0} r() O{0} m O{right} s}{
  \IfBooleanTF{#8}{
    \draw[#1, <->, very thick] (#2, #4) -- (#2 + #3, #4 + #5) node[#7] {#6};
  }{
    \draw[#1, ->, very thick] (#2, #4) -- (#2 + #3, #4 + #5) node[#7] {#6};
  }
}
% \tkzLegende (x) (y) [longueur fleche] {légende} 
% ajouter une * passe de la version gauche -> à la version droite <-
\NewDocumentCommand{\tkzLegende}{O{black} r() r() O{1.25} m s}{
  \IfBooleanTF{#6}{
    \draw[#1, ->, very thick] (#2 + #4, #3) node[right] {#5} -- (#2, #3);
  }{
    \draw[#1, ->, very thick] (#2, #3) node[left] {#5} -- (#2 + #4, #3);
  }
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% plan de classe
\NewDocumentCommand{\texteCadre}{O{black} r() O{2} r() O{2} m}{
  \filldraw [fill=white, draw=#1, ultra thick] (#2, #4) rectangle (#2 + #3, #4 + #5);
  \node at (#2 + #3/2, #4 + #5/2) [font=\sffamily] {\textbf{#6}};
}

%% place dans la classe
\NewDocumentCommand{\place}{r() r() m}{
  \texteCadre(#1)[3](#2)[2] {#3}
}
\NewDocumentCommand{\places}{r()r() r[] d[] d[] d[]}{
  \place(#1)(#2) {#3}
  \IfValueT{#4}{ \place(#1 + 1*3)(#2) {#4} }
  \IfValueT{#5}{ \place(#1 + 2*3)(#2) {#5} }
  \IfValueT{#6}{ \place(#1 + 3*3)(#2) {#6} }
}

%% rangée de classe ou de TP
\NewDocumentCommand{\rangee}{m r[]r[] r()r()r()d() r[]r[]}{
  \places(0)(0 - 3*#1) [#2][#3]
  \IfValueTF{#7}{
    \places(7) (0 - 3*#1) [#4][#5][#6][#7]
    \places(20)(0 - 3*#1) [#8][#9]
  }{
    \places(8.5)(0 - 3*#1) [#4][#5][#6]
    \places(20) (0 - 3*#1) [#8][#9]
  }
}

\NewDocumentCommand{\rangeeTP}{m r[]r[]r[] r()r()r()d()}{
  \places(3)(0 - 3*#1) [#2][#3][#4]
  \IfValueTF{#8}{
    \places(14) (0 - 3*#1) [#5][#6][#7][#8]
  }{
    \places(14) (0 - 3*#1) [#5][#6][#7]
  }
}