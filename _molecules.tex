%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Pour faire des parenthèses dans les molécules 
\def\parentheseG{\llap{$\left(\strut\right.$}}
\def\parentheseD{\rlap{$\left.\strut\right)$}}

%%%% Bouts de molécules fréquement utilisés
%% Hydrogène saturés
\definesubmol\paireH{(-[::90] H) (-[::-90] H)}
\definesubmol\paireSatH{(-[::30] H) (-[::-30] H)}
\definesubmol\saturationH{(-[::90] H) (-[::-90] H) (-[::0] H)}

%% Quelques groupes caractéristiques
\definesubmol\carboxyle{(=[::-50] O) (-[::50] OH)}
\definesubmol\carbonyle{(=[::50] O) -[::-50]}
\definesubmol\ester{(=[:90] O) -[:-30] O}
\definesubmol\ether{-[:30] O -[:-30]}
\definesubmol\amide{(=[:90] O) -[:-30] N}

%% parties colorées
\definesubmol\cetoneCouleur{(=[3,,,,couleurQuat] \textcolor{couleurQuat}{O}) -[-1,,,,couleurQuat]}
%% ramification
\definesubmol\alkyleG{(-[-5] R_1)}
\definesubmol\alkyleD{(-[-1] R_2)}

%%%% Élément récurrent, pour faciliter la lecture
\newcommand{\hydrogene}{\chemfig{H} }
\newcommand{\carbone}{\chemfig{C} }
\newcommand{\oxygene}{\chemfig{O} }
\newcommand{\azote}{\chemfig{N} }
\newcommand{\eau}{\chemfig{H_2O} }
\newcommand{\oxonium}{\chemfig{H_3O^+} }
\newcommand{\hydroxyde}{\chemfig{HO^{-}} }
\newcommand{\azoture}{\chemfig{NaN_3} }
\newcommand{\electron}{\chemfig{e^{-}} }
\newcommand{\ionHydrogene}{\chemfig{H^{+}} }
\newcommand{\bicarbonateSodium}{\chemfig{NaHCO_3} }

%%%% État physique
\newcommand{\aqu}{$_\text{(aq)}$}
\newcommand{\sol}{$_\text{(s)}$}
\newcommand{\liq}{$_\text{(l)}$}
\newcommand{\gaz}{$_\text{(g)}$}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Molécule courante
\definesubmol\paracetamol{
  *6((-HO)-=-(-NH (-[::-60] (=[::-60]O)-[::60]))=-=)
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Lipides
\definesubmol\cc{
  -[::60] -[::-60]
}
\definesubmol\teteAcide{
  O-[::30] (=[::60]O) -[::-60]
}
\definesubmol\teteAcideDev{
  - O - C (=[::90] O) -
}
\definesubmol\cis{
  -[::60] =[::-60] -[::-60]
}
\definesubmol\trans{
  -[::60] =[::-30] -[::-30]
}
\definesubmol\palmitique{
  !\carbonyle !\cc !\cc !\cc !\cc !\cc !\cc !\cc
}
\definesubmol\oleique{
  !\teteAcide !\cc !\cc !\cc !\cis -[::60] !\cc !\cc !\cc
}
\definesubmol\trioleique{
  !\carbonyle !\cc !\cc !\cc -[::60] =[::60] -[::60] !\cc !\cc -[::-60] -[::-60] -[::-60]
}
\definesubmol\linolenique{
  !\teteAcide !\cc !\cc !\cc !\trans !\trans !\trans -[::60]
}
\definesubmol\trilinolenique{
  (=[::60] O) -[::-60] !\cc !\cc !\cc !\cis !\cis !\cis -[::60]
}
\definesubmol\trilinoleique{
  (=[::60] O) -[::-60] !\cc !\cc !\cc !\cis !\cis !\cc !\cc
}
\definesubmol\steraique{
  !\teteAcideDev C_{17}H_{35}
}
\definesubmol\caproique{
  !\teteAcideDev - CH_2 - CH_2 - CH_2 - CH_2 - CH_3
}
\definesubmol\trioleine{
   (-[::150] -[::60] O-[::-60] !\trioleique)
   (-[::-90] -[::-60] O-[::60] !\trioleique)
   -[::30] O-[::60] !\trioleique
}
\definesubmol\tripalmitine{
   (-[::150] -[::60] O-[::-60] (=[::60] O) -[::-60] -[::-60] !\cc !\cc !\cc !\cc !\cc !\cc -[::60]) % haut
   (-[::-90] -[::60] O-[::60] (=[::-60]O) !\cc !\cc !\cc !\cc !\cc !\cc !\cc -[::60]) % centre
   -[::30] O-[::60] !\palmitique % bas
}
\definesubmol\cholesterol{
  HO-[1] *6(-- % 1er cycle
    *6(=-- % 2eme cycle
      *6(- % 3eme cycle
        *5(--- 
          (-[:90] (-[::60]) -[:30] -[:-30] -[:30] -[:-30] (-[:-90]) -[:30]) % lipide
        - (-[:90]) -) % 4eme
      ----) % 3eme
    ---) % 2eme
  - (-[:90]) ---) % 1er
}

%% glycerol
\definesubmol\glycerol{
  HO -[-1] -[1] (-[3] OH) -[-1] -[1] OH
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Glucides
%% Amidon
\definesubmol\amylopectine{
  -[-1]O-[1]
  -[1] (-[3] CH_2 OH)
  -[::-60] O -[::-60]
  (-[::-60] (-[::60]OH) -[::-60] (-[::60]OH) -[::-60])
}
\newcommand{\amylopectineTopologique}{
  {\footnotesize
  \chemfig[atom sep=2.2em]{
    % partie gauche
    ... !\amylopectine !\amylopectine
    % cycle central
    -[-1] O -[-3,1.2] CH_2O -[-3,1.2] % on agrandit l'espace vertical
    -[-1] O -[::-60] (-[::-60] (-[::60]OH) -[::-60] (-[::60]OH) -[::-60]
    % cycle à gauche
    (-[::120,1.25] O -[::-60,1.2]
    *6(-O- (-[,0.5]CH_2OH) -(-[6]O-[6]...) -(-OH) -(-OH)-))
    % partie droite
    -[::-60]) !\amylopectine !\amylopectine -[-1] ...
  }}
}
\definesubmol\amylopectineHamw{
  % début du cycle
  O -[1,0.6]
  % perspective
    <[-1.5,0.7] (-[3,0.6] OH)
    -[,,,,line width=2.4pt] (-[-3,0.6] OH)
    >[1.5,0.7]
  (-[4.5,0.7] O
  -[6] (-[3,0.5] -[5,0.75] OH)
  -[-4.5,0.7])
  % fin du cycle
  -[-1,0.6]
}
\definesubmol\amylopectineGaucheHamw{
  O -[5,0.6]
  % début du cycle, perspective
    <[-4.5,0.7] (-[-3,0.6] OH)
    -[6,,,,line width=2.4pt] (-[3,0.6] OH)
    >[4.5,0.7] (-[1.5,0.7]) (-[-5,0.6] O -[5] ...)
  % fin du cycle
  -[1.5,0.7] (-[3,0.4] -[5,0.6] OH)
  -O -[-1.5,0.7]
}
\definesubmol\amylopectineCentraleHamw{
  O -[-1,0.7] -[-3,0.6]
  % début du cycle
  - O -[-1.5,0.7] ( % perspective
    <[-4.5,0.7] (-[-3,0.6] OH)
    -[6,,,,line width=2.4pt] (-[3,0.6] OH)
    >[4.5,0.7] (-[1.5,0.7]) (-[-5,0.6] !\amylopectineGaucheHamw)
  )
  % fin du cycle
  -[-1,0.6]
}

%% glucose Hamworth : il faut ajouter [cram width=2pt, atom sep=2.5em] au début de la figure
\definesubmol\glucoseHamw{
  % début du cycle
  HO -[3,0.6,2]?
  % Partie en perspective
  <[-1.5,0.7] (-[3,0.6] OH)
  -[,,,,line width=2.4pt] (-[-3,0.6] OH)
  >[1.5,0.7] (-[-3,0.6] OH)
  % fin partie perspective
  -[4.5,0.7] O 
  % fin du cycle
  -[6]? (-[3,0.5] -[5,0.75] OH)
}
%% glucose topologique
\definesubmol\glucoseTopo{
  *6(-(-OH) -(-OH) -(-[3]OH) (-[0]-[1]OH) -O- -(-OH))
}

%% fructose Hamworth : il faut ajouter [cram width=2pt, atom sep=2.5em] au début de la figure
\definesubmol\fructoseHamw{
  % début du cycle
  HO -[3,0.6,2]?
  % Partie en perspective
  <[-1.5,0.7] (-[3,0.6] OH)
  -[,,,,line width=2.4pt] (-[-3,0.6] OH) 
  >[1.5,0.7] (-[3,0.6] OH) (-[-3,0.5] -[-1,0.75] OH)
  % fin partie perspective
  -[4.5,0.7] O 
  % fin du cycle
  -[6]?
}
\definesubmol\fructoseTopo{
  *6(-(-OH) -(-OH) -(-[3]OH) (-[0]-[1]OH) -O- -(-OH))
}

%% Alanine et Glycine dans des polypetptides
\definesubmol\alanine{
  - CH (-[-3] CH_3) - C (=[3] O) -
}
\definesubmol\glycine{
  - CH_2 - C (=[3] O) -
}

%% Hormones
\definesubmol\testosterone{
  O=[1] *6(-= % 1er cycle
    *6(--- % 2eme cycle
      *6(- % 3eme cycle
        *5(--- 
          (-[:70] OH) % alcool
        - (-[:90]) -) % 4eme
      ----) % 3eme
    ---) % 2eme
  - (-[:90]) ---) % 1er
}
\definesubmol\creatinine{
  O= *5(-N (-[-3,0.5]H) -(=NH) -N (-) --)
  %O= *5(-NH -[,2]C(=NH) -N (-CH_3) -CH_2 -C)
}

\definesubmol\DOPA{
  HO -[1] *6(= (-OH) -= (--[-1] (-[-3]NH_2) -[1] COOH) -=-)
}
\definesubmol\DOPAH{
  HO -[1] *6(= (-OH) -= (--[-1] (-[-3]NH_3^+) -[1] COOH) -=-)
}

%% Produit de contraste
\definesubmol\ionChelate{
  N (-[::-45, 0.9,,, draw = none] Gd^{3+}) 
      (-[::140] -[::-60] COO^{-}) -[::80] -[ 0] -[::-80]
    N (-[::140] -[::-60] COO^{-}) -[::70] -[-3] -[::-80]
    N (-[::120] -[::-60] COO^{-}) -[::70] -[-6] -[::-80]
    N (-[::140] -[::-60] ^{-}OOC) -[::70] -[ 3] -[::-80, 0.8]
}
\definesubmol\chelateAlcool{
  N (-[::-45, 0.9,,, draw = none] Gd^{3+}) 
    (-[::140] -[::-60] COO^{-})     -[::80] -[ 0] -[::-80]
  N (-[::140] -[0] (-[2] OH) -[-2]) -[::70] -[-3] -[::-80]
  N (-[::120] -[::-60] COO^{-})     -[::70] -[-6] -[::-80]
  N (-[::140] -[::-60] ^{-}OOC)     -[::70] -[ 3] -[::-80, 0.8]
}