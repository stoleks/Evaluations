%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Pour faire des parenthèses dans les molécules 
\def\parentheseG{\llap{$\left(\strut\right.$}}
\def\parentheseD{\rlap{$\left.\strut\right)$}}

%% Pour avoir des molécules en gras dans un texte
\newcommand{\moleculesGras}{
  \renewcommand*\printatom[1]{\ensuremath{\mathbf{##1}}}
}
\newcommand{\moleculesNormale}{
  \renewcommand*\printatom[1]{\ensuremath{\mathrm{##1}}}
}
\newcommand{\chemfigHaworth}[1]{
  \chemfig[cram width=3pt, atom sep=2.25em]{ #1 }
}

%% parties colorées
\definesubmol\cetoneCouleur{(=[3,,,,couleurQuat] \textcolor{couleurQuat}{O}) -[-1,,,,couleurQuat]}
%% ramification
\definesubmol\alkyleG{(-[-5] R_1)}
\definesubmol\alkyleD{(-[-1] R_2)}

%%%% Élément récurrent, pour faciliter la lecture
\newcommand{\hydrogene}{\chemfig{H} }
\newcommand{\carbone}{\chemfig{C} }
\newcommand{\oxygene}{\chemfig{O} }
\newcommand{\azote}{\chemfig{N} }
\newcommand{\eau}{\chemfig{H_2O} }
\newcommand{\oxonium}{\chemfig{H_3O^+} }
\newcommand{\hydroxyde}{\chemfig{HO^{-}} }
\newcommand{\azoture}{\chemfig{NaN_3} }
\newcommand{\electron}{\chemfig{e^{-}} }
\newcommand{\ionHydrogene}{\chemfig{H^{+}} }
\newcommand{\bicarbonateSodium}{\chemfig{NaHCO_3} }

%%%% État physique
\newcommand{\aq} { \ensuremath{_\text{(aq)}} }
\newcommand{\sol}{ \ensuremath{_\text{(s)}} }
\newcommand{\liq}{ \ensuremath{_\text{(l)}} }
\newcommand{\gaz}{ \ensuremath{_\text{(g)}} }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Pour simplifier certaines molécules
\definesubmol\cu{ -[::60] } % Carbone vers le haut
\definesubmol\cb{ -[::-60] } % carbone vers le bas
\definesubmol\cc{ -[::60] -[::-60] } % Liaison C-C
\definesubmol\cis{ -[::60] =[::-60] -[::-60] } % Liaison -C=C- cis
\definesubmol\trans{ -[::60] =[::-30] -[::-30] } % Liaison -C=C- trans
%% Hydrogène saturés
\definesubmol\paireH{(-[::90] H) (-[::-90] H)}
\definesubmol\paireSatH{(-[::30] H) (-[::-30] H)}
\definesubmol\saturationH{(-[::90] H) (-[::-90] H) (-[::0] H)}
%% Quelques groupes caractéristiques
\definesubmol\teteAcide{ O-[::30] (=[::60] O) -[::-60] }
\definesubmol\teteAcideDev{ - O - C (=[::90] O) - }
\definesubmol\OH { -[::60] OH }
\definesubmol\carboxyle{ (=[::-60] O) (-[::60] OH) }
\definesubmol\carbonyle{ (=[::60] O) -[::-60] }
\definesubmol\ester{ (=[:90] O) -[:-30] O}
\definesubmol\ether{ -[:30] O -[:-30]}
\definesubmol\amide{ (=[:90] O) -[:-30] N}
%% Représentation de hamworth
\definesubmol\gluHaw{
  <[-1.5, 0.7] (-[:90, 0.6] OH)
  -[::45,,,,line width = 3.4pt] (-[:-90, 0.6] OH)
  >[::45, 0.7]
}
\definesubmol\gluLeftHaw{
  <[-4.5, 0.7] (-[:-90, 0.6] OH)
  -[::-45,,,,line width = 3.4pt] (-[:90, 0.6] OH)
  >[::-45, 0.7] (-[1.5,0.7])
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Acides gras
\definesubmol\palmitique{
  HO -[::30] !\carbonyle !\cc !\cc !\cc !\cc !\cc !\cc !\cc
}
\definesubmol\linolenique{
  HO -[::30] !\carbonyle !\cc !\cc !\cc !\trans !\trans !\trans !\cu
}
\definesubmol\oleique{
  HO -[::30] !\carbonyle !\cc !\cc !\cc !\cis !\cu !\cc !\cc !\cc
}
\definesubmol\linoleique{
  HO -[::30] !\carbonyle !\cc !\cc !\cc !\cis !\cis !\cc !\cc
}
\definesubmol\arachidonique{
  HO -[::30] !\carbonyle !\cc !\cis !\cis !\cis !\cis !\cu !\cc !\cu
}
%% Formes semi-developpées
\definesubmol\steraiqueSemiDev{
  !\teteAcideDev C_{17}H_{35}
}
\definesubmol\caproiqueSemiDev{
  !\teteAcideDev - CH_2 - CH_2 - CH_2 - CH_2 - CH_3
}
\definesubmol\oleiqueSemiDev{
  C_{17} H_{33} -C (=[1.5]O) (-[-1.5]OH)
}
\definesubmol\oleateSemiDev{
  C_{17} H_{33} -C (=[1.5]O) (-[-1.5]O^{-})
}
%% Pour l'utilisation dans les lipides
\definesubmol\tripalmitique{
  !\cc !\cc !\cc !\cc !\cc !\cc !\cu
}
\definesubmol\trilinolenique{
  !\cc !\cc !\cc !\cis !\cis !\cis !\cu
}
\definesubmol\trioleique{
  !\cc !\cc !\cc !\cu =[::60] !\cu !\cc !\cc !\cb !\cb !\cb
}
\definesubmol\trilinoleique{
  !\cc !\cc !\cc !\cis !\cis !\cc !\cc
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Lipide
\definesubmol\oleine{
   (-[::150] !\cu O-[::-60] !\carbonyle !\trioleique)
   (-[::-90] -[::-60] O!\cu !\carbonyle !\trioleique)
   -[::30] O!\cu !\carbonyle !\trioleique
}
\definesubmol\palmitine{
   (-[::150] !\cu O-[::-60] (=[::60] O) !\carbonyle !\cb !\cb !\tripalmitique) % haut
   (-[::-90] !\cu O!\cu (=[::-60]O) !\carbonyle !\cc !\tripalmitique) % centre
   -[::30] O!\cu !\carbonyle !\cc !\cc !\tripalmitique % bas
}
\definesubmol\phosphatidylcholine{
  -[::-30]N
    (-[::-30])(-[::-90])
  !\cc !\cu O !\cb P
    ( =[::-30]O )( -[::-90]O )
  !\cu O !\cb !\cu
    (!\cu O !\cb !\carbonyle !\trioleique)
  !\cb !\cu O !\cb (=[::-60] O) !\cc !\cc !\cc !\cc !\cc
}
\definesubmol\oleineSemiDev{
  H C                 (!\teteAcideDev C_{17} H_{33}) 
  (-[3,1.7,2,2] H_2C  (!\teteAcideDev C_{17} H_{33}))
  -[-3,1.7,2,2] H_2 C (!\teteAcideDev C_{17} H_{33})
}
\definesubmol\caproineSemiDev{
  H_2C                (!\caproiqueSemiDev)
  -[-3,1.7,2,2] H C   (!\caproiqueSemiDev)
  -[-3,1.7,2,2] H_2 C (!\caproiqueSemiDev)
}

%% glycérol
\definesubmol\glycerol{
  HO -[-1] 
  -[1] (-[3] OH)
  -[-1] -[1] OH
}
\definesubmol\glycerolSemiDev{
  HC (-OH)
  (-[3,,2,2] H_2C (-OH))
  -[-3,,2,2] H_2C (-OH)
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Stérols
\definesubmol\cholesterol{
  HO-[1] *6(-- % 1er cycle
    *6(=-- % 2eme cycle
      *6(- % 3eme cycle
        *5(--- 
          (-[:90] (!\cu) -[:30] -[:-30] -[:30] -[:-30] (-[:-90]) -[:30]) % lipide
          - (-[:90]) -
        ) % 4eme
        ----
      ) % 3eme
      ---
    ) % 2eme
    - (-[:90]) ---
  ) % 1er
}
\definesubmol\testosterone{
  O=[1] *6(-=
    *6(---
      *6(-
        *5(--- 
          (-[:70] OH) % alcool
        --
        ) % 4
      - (-[::0]) ---
      ) % 3
    ---
    ) % 2
  - (-[::0]) ---
  ) % 1
}
\definesubmol\cortisol{
  O=[::30] *6(
    -= *6(
      --- *6(
        - *5(
          --- (-[::-100] OH)
          (-[::-35] (=[::60] O) !\cb!\cu OH)
          -
        ) % 4
        - (-[::0]) -- (-OH) -
      ) % 3
      --
    ) % 2
    - (-[::0]) ---
  ) % 1
}
\definesubmol\progesterone{
  O=[::30] *6(
    -=  *6(
      --- *6(
        - *5(--- (=O) -)
        - (-[::0])
        ---
      ) % 3
      --
    ) % 2
    - (-[::0]) ---
  ) % 1
}

\definesubmol\estradiol{
    HO-[::30] *6(
    -= *6(
      --- *6(
        - *5(--- (-OH) -)
        - (-[::0]) ---
      ) % 3
      --
    ) % 2
    -=-=
  ) % 1
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Glucides
%% Amidon
\definesubmol\amylopec{
  -[-1]O-[1]
  -[1] (-[3] CH_2 OH)
  -[::-60] O -[::-60]
  (-[::-60] (!\OH) !\cb (!\OH) !\cb)
}
\newcommand{\amylopectine}{
  % partie gauche
  ... !\amylopec !\amylopec
  % cycle central
  -[-1] O -[-3,1.2] CH_2O -[-3,1.2] % on agrandit l'espace vertical
  -[-1] O !\cb (!\cb (-[::60] OH) !\cb (-[::60] OH) !\cb
  % cycle à gauche
  (-[::120,1.25] O -[::-60,1.2]
  *6(-O- (-[,0.5]CH_2OH) -(-[6]O-[6]...) -(-OH) -(-OH)-))
  % partie droite
  !\cb) !\amylopec !\amylopec -[-1] ...
}
\definesubmol\amylopecHaw{
  % début du cycle
  O -[1,0.6]
  !\gluHaw
  (-[4.5,0.7] O
  -[6] (-[3,0.5] -[5,0.75] OH)
  -[-4.5,0.7])
  % fin du cycle
  -[-1,0.6]
}
\definesubmol\amylopecGaucheHaw{
  O -[5,0.6]
  % début du cycle, perspective
  !\gluLeftHaw  (-[-5,0.6] O -[5] ...)
  % fin du cycle
  -[1.5,0.7] (-[3,0.4] -[5,0.6] OH)
  -O -[-1.5,0.7]
}
\definesubmol\amylopecCentraleHaw{
  O -[-1,0.7] -[-3,0.6]
  % début du cycle
  - O -[-1.5,0.7] ( % perspective
    !\gluLeftHaw  (-[-5,0.6] !\amylopecGaucheHaw)
  )
  % fin du cycle
  -[-1,0.6]
}
\definesubmol\amylopectineHaw{
  ...\phantom{B}-[-1] !\amylopecHaw
  !\amylopecHaw O -[-3]
  !\amylopecCentraleHaw
  !\amylopecHaw !\amylopecHaw O -[1]..
}

%% glucose
\definesubmol\glucoseHaw{
  % début du cycle
  HO -[3,0.6,2]?
  !\gluHaw
  (-[-3,0.6] OH)
  -[4.5,0.7] O 
  % fin du cycle
  -[6]? (-[3,0.5] -[5,0.75] OH)
}
\definesubmol\glucoseCycle{
  *6 (-(-OH) -(-OH) -(-OH) -O -(- -[3]OH) -) (-[-5]HO)
}
\definesubmol\glucose{
  HO -[6] (-[-4] (-[6] HO) -[-2] -[-4] HO) -[4] (-[6] HO) -[2] (-OH) -[4] (=[6] O) -[2] H
}
\definesubmol{\ose}{ -[-3] C (-H) (-[6] HO) }
\definesubmol\glucoseSemiDev{
  HO -C (-H) (
    -[3] C (-H) (-[6] HO)
    (-[3] C (-[5]H) =[1] O)
  ) % aldehyde et alcool
  !\ose !\ose !\ose
  -[-3] H
}

%% fructose
\definesubmol\fructoseHaw{
  % début du cycle
  HO -[3,0.6,2]?
  !\gluHaw 
  (-[-3,0.5] -[-1,0.75] OH)
  -[4.5,0.7] O 
  % fin du cycle
  -[6]?
}
\definesubmol\fructoseCycle{
  *6(-(-OH) -(-OH) -(-[3]OH) (-[0]-[1]OH) -O- -(-OH))
}
\definesubmol\fructose{
  HO -[6] (-[-4] (-[6] HO) -[-2] -[-4] HO) -[4] (-[6] HO) -[2] (=O) -[4] -[2] OH
}
\definesubmol\fructoseSemiDev{
  HO -C (-H) (
    -[3] C (=O)
    (-[3] C (-[3]H) (-[6]H) -OH)
  ) % cétone et alcool
  !\ose !\ose !\ose
  -[-3] H
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Acides alpha aminés
\definesubmol\isoleucine{
  H_2N -[1] (-[3] (-[1]) -[5] -[3]) -[-1] !\carboxyle
}
\definesubmol\leucine{
  H_2N -[1] (-[3] -[5] (-[-5]) -[3]) -[-1] !\carboxyle
}
\definesubmol\methionine{
  H_2N -[1] (-[3] -[5] -[3] S -[5]) -[-1] !\carboxyle
}
\definesubmol\valine{
  H_2N -[1] (-[3] (-[1]) -[5]) -[-1] !\carboxyle
}
\definesubmol\alanineSemiDev{
  CH_3- CH (-[-3] NH_2) - C (=[1.5] O) -[-1.5] OH
}
\definesubmol\asparagineSemiDev{
  HO -[1]C (=[3] O) -[-1]CH (-[-3] NH_2) -[1]CH_2 -[-1]C (-[-3] NH_2) =[1] O
}
\definesubmol\glycineSemiDev{
  NH_2- CH_2- C (=[1.5] O) -[-1.5] OH
}
\definesubmol\alaninePoly{
  - CH (-[-3] CH_3) - C (=[3] O) -
}
\definesubmol\glycinePoly{
  - CH_2 - C (=[3] O) -
}
\definesubmol\isoleucinePoly{
  -CH (-[-3] CH (-[-5] CH_2 -[-3]CH_3) -[-1]CH_2) -C (=[3] O) -
}
\definesubmol\valinePoly{
  -CH (-[3] CH (-[5] CH_3) -[1]CH_2) -C (=[-3] O) -
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Hormones
\definesubmol\creatinine{
  O= *5(-N (-[-3,0.5]H) -(=NH) -N (-) --)
}
\definesubmol\DOPA{
  HO -[1] *6(= (-OH) -= (--[-1] (-[-3]NH_2) -[1] COOH) -=-)
}
\definesubmol\DOPAH{
  HO -[1] *6(= (-OH) -= (--[-1] (-[-3]NH_3^+) -[1] COOH) -=-)
}
\definesubmol\prostaglandine{
  OH-[::75] *5(
    - (
      -=[::60]!\cb  (!\cb OH) !\cc !\cc !\cu 
    )
    - (-[::-65]!\cb !\cc !\cc !\cu  (=[::60]O) !\cb OH)
    - (=O)
    --
  )
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Produit de contraste
\definesubmol\ionChelate{
  N (-[::-45, 0.9,,, draw = none] Gd^{3+}) 
      (-[::140] !\cb COO^{-}) -[::80] -[ 0] -[::-80]
    N (-[::140] !\cb COO^{-}) -[::70] -[-3] -[::-80]
    N (-[::120] !\cb COO^{-}) -[::70] -[-6] -[::-80]
    N (-[::140] !\cb ^{-}OOC) -[::70] -[ 3] -[::-80, 0.8]
}
\definesubmol\chelateAlcool{
  N (-[::-45, 0.9,,, draw = none] Gd^{3+}) 
    (-[::140] !\cb COO^{-})         -[::80] -[ 0] -[::-80]
  N (-[::140] -[0] (-[2] OH) -[-2]) -[::70] -[-3] -[::-80]
  N (-[::120] !\cb COO^{-})         -[::70] -[-6] -[::-80]
  N (-[::140] !\cb ^{-}OOC)         -[::70] -[ 3] -[::-80, 0.8]
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Vitamines
\definesubmol\acideAscorbique{ % Vitamine C
  HO-[-1] -[1](-[3]OH) -[-1] 
  *5(
    -(-OH) =(-OH) -(=O) -O-
  )
}
\definesubmol\cholecarciferol{ % Vitamine D
  OH-[-1]
  *6( % 1er cycle
    ---(=)- ( % ramification
      = !\cb =[::60] *6(- % 2eme
        *5(
          --- (-(-[::60]) !\cb !\cc -[::60](-[::60]) !\cb) --
        ) % 3eme
        -(-[::0])----
      ) % 2eme
    ) % ramification
    --
  ) % 1er
}
\definesubmol\cret{ =[-1] -[1] }
\definesubmol\retinol{ % Vitamine A
  *6( % cycle
    --(-)= ( % chaine
      -[1] !\cret (-[3]) !\cret !\cret (-[3]) !\cret OH
    ) % chaine
    -(-[1])(-[5])--
  ) % cycle
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Aspirine
\definesubmol\aspirineSemiDev{
  O=[-1] C (-[1]OH) -[-3]C % carboxyle
  *6( % cycle
    =HC -[,,2,2]HC =\chembelow{C}{H} -CH =C (
      -[1] O -[-1] C (=[-3] O) -[1]CH_3 % cétone
    )
    -
  ) % cyle
}
\definesubmol\aspirine{
  *6 (
    -=- (-O -[-1] (=[-3]) -[1]) = (- (=[5] O) -[1] OH) -=
  )
}

%% Paracétamol
\definesubmol\paracetamol{
  *6(
    (-HO)-=-(
      -NH (!\cb (=[::-60]O)!\cu)
    ) % amide
    =-=
  )
}
\definesubmol\paracetamolSemiDev{
  *6(
    C (-HO) -CH =CH -C (
      -NH (-[-1]C (=[-3]O) -CH_3)
    ) % amide
    =CH -HC =[,4,2]
  )
}
\definesubmol\paracetamolDev{
  H -O -[1]C *6(
    -C(-H) =C(-H) -C (
      -N (-[3]H) (-[-1]C (=[-3]O) (-C!\saturationH)) 
    ) % amide
    =C(-H) -C(-H) =
  )
}

%% Aspartame
\definesubmol\aspartame{
  [:150]
  *6(-=-=-=) % phenyl
  -[0]-[-2] (
    -[-4] (=[6]O) -[-2]O -[-4]
  ) % ester
  -[0]NH -[-2,,1] (=[-4] O) % Amide
  -[0] (
    -[2] NH_2
  ) % amine
  -[-2] -[0] (=[2] O) -[-2] OH % acide carboxylique
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Molécules odorantes
%% géraniol
\definesubmol\geraniol{
  -[-3] *6( % tete
    --- 
      (= (!\cb) (!\cu)) % pied
    -[,,,,draw=none] -[,,,,draw=none]
      (- !\cb OH) % alcool
    =
  )
}
\definesubmol\geraniolSemiDev{
  CH_3 -[-3]C *6 ( % tete
    -H_2C -[,,2,2]H_2C -CH 
      (=C (!\cb CH_3) (!\cu CH_3)) % pied
    -[,,1,1,draw=none] -[,,,,draw=none]CH
      (-CH_2 !\cb OH) % alcool
    =CH_2 
  )
}
\definesubmol\oxyphenylone{
  HO -[::30] *6(
    -=- (
      -!\cb !\cu (=[::60]O) !\cb 
    )
    =-=
  )
}
\definesubmol\vanilline{
  O=[::-30] (!\cu H)
  !\cb  *6(
    - = - (-OH)
    = (-O!\cu)
    -=
  )
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Drogues
\definesubmol\THC{
  -[::-90] *6 ( % 1er
    --- *6 ( % 2eme
      - (-[::-90]) (-[::-30])
      -O- *6 ( % 3eme
        -= (!\cb !\cc !\cc)
        -= (!\cb OH) -=
      )
      --
    )
    --=
  )
}
\definesubmol\cocaineHaw{
    ? 
      <[::60,0.7] (-[::60] N -[::60])
      -[::-60,,,,line width = 3.4pt]
      >[::-30,0.7] ( % ether-phenyl
        -[::60] O -[::-60] (=[::-60]O)
        !\cu  *6(=-=-=-)
      )
    -[::130,0.7] ( % ester
      -[::-50] (=[::60]O)
      !\cb O !\cu 
    )
    -[::80, 0.9] (-[::-30, 0.85]) -[::60, 0.7] ?
}