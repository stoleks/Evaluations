%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Réglage de chemfig
\setchemfig{
  atom sep=24pt,
  bond style={line width=1pt},
  angle increment=30
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Pour faire des parenthèses dans les molécules 
\def\parentheseG{\llap{$\left(\strut\right.$}}
\def\parentheseD{\rlap{$\left.\strut\right)$}}

%% Pour avoir des molécules en gras dans un texte
\newcommand{\moleculesGras}{
  \renewcommand*\printatom[1]{\ensuremath{\mathbf{##1}}}
}
\newcommand{\moleculesNormale}{
  \renewcommand*\printatom[1]{\ensuremath{\mathrm{##1}}}
}
\newcommand{\chemfigHaworth}[1]{
  \chemfig[cram width=2.2pt, atom sep=2.em]{ #1 }
}

%%%% Éléments récurrents 
\newcommand{\hydrogene}{\chemfig{H}\xspace}
\newcommand{\carbone}  {\chemfig{C}\xspace}
\newcommand{\oxygene}  {\chemfig{O}\xspace}
\newcommand{\azote}    {\chemfig{N}\xspace}
\newcommand{\electron} {\chemfig{e^{-}}\xspace}
%%%% Molécules récurrentes
\newcommand{\dioxygene}          {\chemfig{O_2}\xspace}
\newcommand{\diazote}            {\chemfig{N_2}\xspace}
\newcommand{\dioxydeDeCarbone}   {\chemfig{CO_2}\xspace}
\newcommand{\eau}                {\chemfig{H_2O}\xspace}
\newcommand{\methane}            {\chemfig{CH_4}\xspace}
\newcommand{\ammoniac}           {\chemfig{NH_3}\xspace}
\newcommand{\diiode}             {\chemfig{I_2}\xspace}
\newcommand{\acideCarbonique}    {\chemfig{H_2CO_3}\xspace}
\newcommand{\carbonateDeCalcium} {\chemfig{CaCO_3}\xspace}
\newcommand{\bicarbonateDeSodium}{\chemfig{NaHCO_3}\xspace}
\newcommand{\azotureDeSodium}    {\chemfig{NaN_3}\xspace}
\newcommand{\chlorureDArgent}    {\chemfig{AgCl}\xspace}
%%%% Ions récurrents
\newcommand{\oxonium}     {\chemfig{H_3O^{+}}\xspace}
\newcommand{\hydroxyde}   {\chemfig{HO^{-}}\xspace}
\newcommand{\ionHydrogene}{\chemfig{H^{+}}\xspace}
\newcommand{\ammonium}    {\chemfig{NH_4^{+}}\xspace}
\newcommand{\nitrate}     {\chemfig{NO_3^{-}}\xspace}
\newcommand{\sulfate}     {\chemfig{SO_4^{2-}}\xspace}
\newcommand{\chlorure}    {\chemfig{Cl^{-}}\xspace}
\newcommand{\fluorure}    {\chemfig{F^{-}}\xspace}
\newcommand{\carbonate}   {\chemfig{CO_3^{2-}}\xspace}
\newcommand{\bicarbonate} {\chemfig{HCO_3^{-}}\xspace}
\newcommand{\ionOxygene}  {\chemfig{O^{2-}}\xspace}
\newcommand{\ionFerII}    {\chemfig{Fe^{2+}}\xspace}
\newcommand{\ionFerIII}   {\chemfig{Fe^{3+}}\xspace}
\newcommand{\ionSodium}   {\chemfig{Na^{+}}\xspace}
\newcommand{\ionArgent}   {\chemfig{Ag^{+}}\xspace}
\newcommand{\hypochlorite}{\chemfig{ClO^{-}}\xspace}
\newcommand{\ionCuivreII} {\chemfig{Cu^{2+}}\xspace}
\newcommand{\ionCalcium}  {\chemfig{Ca^{2+}}\xspace}
\newcommand{\ionMagnesium}{\chemfig{Mg^{2+}}\xspace}
\newcommand{\ionPotassium}{\chemfig{K^{+}}\xspace}

%%%% État physique
\newcommand{\aq} { \ensuremath{_\text{(aq)}} }
\newcommand{\sol}{ \ensuremath{_\text{(s)}} }
\newcommand{\liq}{ \ensuremath{_\text{(l)}} }
\newcommand{\gaz}{ \ensuremath{_\text{(g)}} }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Pour simplifier certaines molécules
\definesubmol\blank{ -[,,,, draw = none] } % liaison invisible
\definesubmol\vide1{ -[#1,,,, draw = none] } % liaison invisible avec angle réglable
\definesubmol\cu   { -[::60] }  % C-C vers le haut (carbon up)
\definesubmol\cd   { -[::-60] } % C-C vers le bas (carbon down)
\definesubmol\cud  { -[::60] -[::-60] } % Liaison C-C-C ^ (carbon up down)
\definesubmol\cdu  { -[::-60] -[::60] } % Liaison C-C-C v (carbon down up)
\definesubmol\ccu  { =[::60] }  % Liaison C=C vers le haut
\definesubmol\ccd  { =[::-60] } % Liaison C=C vers le haut
\definesubmol\cis  { -[::60] =[::-60] -[::-60] } % Liaison -C=C- cis
\definesubmol\trans{ -[::60] =[::-30] -[::-30] } % Liaison -C=C- trans
%% Hydrogènes saturés
\definesubmol\HH {(-[::90] H) (-[::-90] H)} % paire H- R -H
\definesubmol\HHH{(-[::90] H) (-[::-90] H) (-[::0] H)} % triplet H- RH -H
%% Quelques groupes caractéristiques
\definesubmol\teteAcide   { O-[::30] (=[::60] O) -[::-60] }
\definesubmol\teteAcideDev{ -O-C (=[::90] O) - }
\definesubmol\carboxyle   { (=[::-60] O) (-[::60] OH) }
\definesubmol\carboxyleDev{ (=[::-50] O) (-[::50] OH) }
\definesubmol\carbonyle   { (=[::60] O) -[::-60] }
\definesubmol\ester       { (=[:90] O) -[:-30] O}
\definesubmol\ether       { -[:30] O -[:-30]}
\definesubmol\amide       { (=[:90] O) -[:-30] N}
\definesubmol\phosphate   { P (=[::-90] O) (-[::90] \charge{45:1.5pt=$\scriptstyle-$}{O}) -[::0] O}

%%%% Pour des molécules colorées
\definesubmol\cuCouleur {-[ ::60,,,, couleurQuat, line width = 1.5pt]}
\definesubmol\cdCouleur {-[::-60,,,, couleurQuat, line width = 1.5pt]}
\definesubmol\ccuCouleur{=[ ::60,,,, couleurQuat, line width = 1.5pt]}
\definesubmol\ccdCouleur{=[::-60,,,, couleurQuat, line width = 1.5pt]}
\definesubmol\couleur1  {\textcolor{couleurQuat}{#1}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Acides gras
\definesubmol\palmitique{
  H !\teteAcide !\cud !\cud !\cud !\cud !\cud !\cud !\cud
}
\definesubmol\linolenique{
  H !\teteAcide !\cud !\cud !\cud !\trans !\trans !\trans !\cu
}
\definesubmol\oleique{
  H !\teteAcide !\cud !\cud !\cud !\cis !\cu !\cud !\cud !\cud
}
\definesubmol\linoleique{
  H !\teteAcide !\cud !\cud !\cud !\cis !\cis !\cud !\cud
}
\definesubmol\arachidonique{
  H !\teteAcide !\cud !\cis !\cis !\cis !\cis !\cu !\cud !\cu
}
\definesubmol\eicosaPentaenoique{
  H !\teteAcide !\cu !\cu !\cis !\cis !\cis !\cis !\cis !\cu
}
\definesubmol\docosaHexanoique{
  H !\teteAcide !\cu !\cis !\cis !\cu =[::60] !\cu !\cis !\cis !\cis !\cu
}
\definesubmol\oleiqueSemiDev{
  C_{17} H_{33} -C !\carboxyleDev
}
\definesubmol\oleateSemiDev{
  C_{17} H_{33} -C (=[::-50] O) (-[::50] O^{-})
}
\definesubmol\steraiqueSemiDev{
  C_{17}H_{35} -C !\carboxyleDev
}
\definesubmol\caproiqueSemiDev{
  CH_2 - CH_2 - CH_2 - CH_2 - CH_2 - C !\carboxyleDev
}
%% Pour l'utilisation dans les triglycérides
\definesubmol\tripalmitique{
  !\cdu !\cdu !\cdu !\cdu !\cdu !\cdu !\cd
}
\definesubmol\trilinolenique{
  !\cud !\cud !\cud !\cis !\cis !\cis !\cu
}
\definesubmol\trioleique{
  !\cud !\cud !\cud !\cu !\ccu !\cu !\cud !\cud !\cd !\cd !\cd
}
\definesubmol\trilinoleique{
  !\cud !\cud !\cud !\cis !\cis !\cud !\cud
}
%% Formes semi-developpées
\definesubmol\tristeraiqueSemiDev{
  !\teteAcideDev C_{17} H_{35}
}
\definesubmol\tricaproiqueSemiDev{
  !\teteAcideDev CH_2 - CH_2 - CH_2 - CH_2 - CH_3
}
\definesubmol\trioleiqueSemiDev{
  !\teteAcideDev C_{17} H_{33}
}
\definesubmol\tripalmitiqueSemiDev{
  !\teteAcideDev C_{15} H_{31}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Lipide
\definesubmol\oleine{
   (-[::150] !\cu O !\cd !\carbonyle !\trioleique)
   (-[::-90] !\cd O!\cu !\carbonyle !\trioleique)
   -[::30] O!\cu !\carbonyle !\trioleique
}
\definesubmol\palmitine{
   (-[::150] !\cu O !\cd !\carbonyle !\tripalmitique !\cu) % haut
   (-[::-90] !\cu O !\cu (!\ccd O) !\cu !\tripalmitique !\cu) % bas
   -[::30] O!\cu !\carbonyle !\cu !\tripalmitique % centre
}
\definesubmol\phosphatidylcholine{
  % choline
  -[::-30] \charge{90:4pt=$+$}{N}
    (-[::-30])(-[::-90])
  % phosphate
  !\cud !\cu O !\cd P
    ( =[::-20]O )( -[::-100]\charge{140:2pt=$-$}{O} )
  % diglycéride
  !\cu O !\cd !\cu (!\cu O !\cd !\carbonyle !\trioleique)
  !\cd !\cu O !\cd (!\ccd O) !\cud !\cud !\cud !\cud !\cud
}
\definesubmol\oleineSemiDev{
  H C                 (!\trioleiqueSemiDev)
  (-[3,1.7,2,2] H_2C  (!\trioleiqueSemiDev))
  -[-3,1.7,2,2] H_2 C (!\trioleiqueSemiDev)
}
\definesubmol\caproineSemiDev{
  H C                 (!\tricaproiqueSemiDev)
  (-[3,1.7,2,2] H_2C  (!\tricaproiqueSemiDev))
  -[-3,1.7,2,2] H_2 C (!\tricaproiqueSemiDev)
}
\definesubmol\palmitineSemiDev{
  H C                 (!\tripalmitiqueSemiDev)
  (-[3,1.7,2,2] H_2C  (!\tripalmitiqueSemiDev))
  -[-3,1.7,2,2] H_2 C (!\tripalmitiqueSemiDev)
}

%% glycérol
\definesubmol\glycerol{
  HO !\cdu (!\cu OH) !\cdu OH
}
\definesubmol\glycerolSemiDev{
  HC (-OH)
  (-[3,,2,2] H_2C (-OH))
  -[-3,,2,2] H_2C (-OH)
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Stérols
\definesubmol\cholesterol{
  HO-[1] *6(-- % 1er cycle
    *6(=-- % 2eme cycle
      *6(- % 3eme cycle
        *5(--- 
          (-[::-35] (!\cu) !\cd !\cd !\cud (!\cd) !\cu) % lipide
          -  -
        ) % 4eme
        - (-[::0]) ---
      ) % 3eme
      ---
    ) % 2eme
    - (-[::0]) ---
  ) % 1er
}
\definesubmol\testosterone{
  O=[1] *6(-=
    *6(---
      *6(-
        *5(--- (- OH) --) % 4
      - (-[::0]) ---
      ) % 3
    ---
    ) % 2
  - (-[::0]) ---
  ) % 1
}
\definesubmol\cortisol{
  O=[::30] *6(
    -= *6(
      --- *6(
        - *5(
          --- (-[::-100] OH)
          (-[::-35] (!\ccu O) !\cd!\cu OH)
          -
        ) % 4
        - (-[::0]) -- (-OH) -
      ) % 3
      --
    ) % 2
    - (-[::0]) ---
  ) % 1
}
\definesubmol\progesterone{
  O=[::30] *6(
    -=  *6(
      --- *6(
        - *5(--- (=O) -)
        - (-[::0])
        ---
      ) % 3
      --
    ) % 2
    - (-[::0]) ---
  ) % 1
}

\definesubmol\estradiol{
    HO-[::30] *6(
    -= *6(
      --- *6(
        - *5(--- (-OH) -)
        - (-[::0]) ---
      ) % 3
      --
    ) % 2
    -=-=
  ) % 1
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Glucides
%% Pour la représentation de Haworth du glucose ou du fructose
\definesubmol\gluHaw{
  -[:90,0.01,,,draw = none]
  %% Bas du cycle
  <[::-140,0.9] (-[::140,0.7] OH) 
  -[::50,1.1,,,line width=3pt] (-[::-90,0.7] OH)
  >[::45,0.9]
  %% haut du cycle
  -[::90,0.9]O -[::45] (-[::-90,0.5] -[::60,0.7,,2] HO) -[::40,0.9]
  %% pour retourner sur la droite du cycle
  -[::180,0.9,,, draw = none] -[::-40,1,,, draw = none] -[::-45,0.9,,, draw = none]
}
\definesubmol\fruHaw{
  -[:90,0.01,,,draw = none]
  %% Bas du cycle
  <[::-140,0.9] (-[::140,0.7] OH) 
  -[::50,1.1,,,line width=3pt] (-[::-90,0.7] OH)
  >[::45,0.9]
  %% haut du cycle
  -[::90,0.9]O -[::45] -[::40,0.9]
  %% pour retourner sur la droite du cycle
  -[::180,0.9,,, draw = none] -[::-40,1,,, draw = none] -[::-45,0.9,,, draw = none]
}

%%% Amidon
\definesubmol\amylopectineHaw{
  %% Glucoses du haut
  \cdots\phantom{O} -[::-20,1.4] O-[::30,0.8] !\gluHaw 
  -[::30,0.8] O-[::30,0.8] !\gluHaw
  -[::30,0.8] O-[::-75,1.2] 
  %% Haut du Centre
  O-[::60,0.7] -[::-60,0.7] -[::90] O-[::-45,0.9] (
    %% Glucoses à droite
    -[::30,0.8] O-[::30,0.8] !\gluHaw -[::30,0.8] O-[::30,1.4] \phantom{O}\cdots
  )
  %% Bas du centre
  <[::-90,0.9] (-[::45,0.7] OH)
  -[::-45,1.1,,,line width=3pt] (-[::-90,0.7] OH)
  >[::-45,0.9]
  -[::-95] -[::180] % pour revenir à gauche du cycle
  %% Glucose à gauche
  -[::-20,0.8] O-[::-40,0.8]
  <[::65,0.9] (-[::45,0.7] OH)
  -[::-45,1.1,,,line width=3pt] (-[::-90,0.7] OH)
  >[::-45,0.9] (-[::60,0.8] O-[::-30,1.4] \phantom{O}\cdots)
  -[::-95,0.9] (-[::50,0.5] -[::60,0.7,,2] HO) -[::-40,1.1] O-[::-45,0.9]
}
%% Pour faciliter l'écriture d'un sucre en formule développée
\definesubmol{\ose} { -[::0] C (-[::-90] H) (-[::90] OH) }

%% glucose
\definesubmol\glucoseHaw{
  HO -[::90,0.9,2] !\gluHaw -[::-45,0.7,,1] OH
}
\definesubmol\glucoseCycle{
  HO -[::30] *6 (-(-OH) -(-OH) -(-OH) -O- (- !\cd OH)-)
}
\definesubmol\glucose{
  H -[::30] (!\ccu O) !\cd (!\cd OH) !\cu (!\cu OH) !\cd (!\cd OH) !\cu (!\cu OH) !\cd !\cu OH
}
\definesubmol\glucoseSemiDev{
  C (-[::120] H) (=[::-120] O) !\ose !\ose !\ose !\ose !\ose (-[::0] OH)
}

%% fructose
\definesubmol\fructoseHaw{
  HO -[::90,0.9,2] !\fruHaw (-[::130,0.7,,1] OH) -[::-45,0.7] -[::60,0.7,,1] OH
}
\definesubmol\fructoseCycle{
  HO -[::30] *6 (-(-OH) -(-OH) -(-[::0] OH) (-[::-90] !\cu OH) -O--)
}
\definesubmol\fructose{
  HO -[::30] !\cd (!\ccd O) !\cu (!\cu OH) !\cd (!\cd OH) !\cu (!\cu OH) !\cd !\cu OH
}
\definesubmol\fructoseSemiDev{
  OH -[::0]  C!\HH -[::0] C (=[::90] O) !\ose !\ose !\ose !\ose (-[::0] H)
}

%%%% Ribose
\definesubmol{\ribose}{
  % liaison à droite et cycle
  -[::-30] !\cd *5([::70]- (-HO) -(-OH) --O-)
  % imite les angles du cycle pour pouvoir ajouter une chaîne à gauche
  !\vide{::124} !\vide{::-72} -[::128]
}
\definesubmol{\riboseHaw}{
  % liaison à droite
  -[::-30] !\cd
  % cycle ouvert et fermé par ? (4 liaisons à tracer du coup)
  ? <[::30,0.7] (!\cd HO) -[::60,,,,line width= 3pt] (!\cd OH) >[::60, 0.7] -[::90]O ?
  % on repart à l'envers de l'oxygène pour pouvoir ajouter une chaîne à gauche
  !\vide{::180} -[::120]
}
\definesubmol{\desoxyribose}{
  % liaison à droite et cycle
  -[::-30] !\cd *5([::70]- (-HO) ---O-)
  % imite les angles du cycle pour pouvoir ajouter une chaîne à gauche
  !\vide{::124} !\vide{::-72} -[::128]
}
\definesubmol{\desoxyriboseHaw}{
  % liaison à droite
  -[::-30] !\cd
  % cycle ouvert et fermé par ? (4 liaisons à tracer du coup)
  ? <[::30,0.7] (!\cd HO) -[::60,,,,line width= 3pt] >[::60, 0.7] -[::90]O ?
  % on repart à l'envers de l'oxygène pour pouvoir ajouter une chaîne à gauche
  !\vide{::180} -[::120]
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Base nucléique
\definesubmol{\adenine} { *5(- *6(-N=-N= (-[,,,1]NH_2) -) =-N=-) }
\definesubmol{\guanine} { *5(- *6(-N= (-[,,,1]NH_2) -[,,,1] NH -(=O)-) =-N=-) }
\definesubmol{\thymine} { *6(- (=O) -[,,,1] NH -(=O) -(-)=-) }
\definesubmol{\uracile} { *6(- (=O) -[,,,1] NH -(=O) -=-) }
\definesubmol{\cytosine}{ *6(- (=O) -N= (-NH_2) -=-) }

%%% Ribonucléoside
\definesubmol{\adenosine}{ !\ribose N !\adenine }
\definesubmol{\cytidine} { !\ribose N !\cytosine }
\definesubmol{\guanosine}{ !\ribose N !\guanine }
\definesubmol{\thymidine}{ !\ribose N !\thymine }
\definesubmol{\uridine}  { !\ribose N !\uracile }
%%
\definesubmol{\adenosineHaw}{ !\riboseHaw N !\adenine }
\definesubmol{\cytidineHaw} { !\riboseHaw N !\cytosine }
\definesubmol{\guanosineHaw}{ !\riboseHaw N !\guanine }
\definesubmol{\thymidineHaw}{ !\riboseHaw N !\thymine }
\definesubmol{\uridineHaw}  { !\riboseHaw N !\uracile }
%% Desoxyribonucléoside
\definesubmol{\desoxyAdenosine}{ !\desoxyribose N !\adenine }
\definesubmol{\desoxyCytidine} { !\desoxyribose N !\cytosine }
\definesubmol{\desoxyGuanosine}{ !\desoxyribose N !\guanine }
\definesubmol{\desoxyThymidine}{ !\desoxyribose N !\thymine }
\definesubmol{\desoxyUridine}  { !\desoxyribose N !\uracile }
%%
\definesubmol{\desoxyAdenosineHaw}{ !\desoxyriboseHaw N !\adenine }
\definesubmol{\desoxyCytidineHaw} { !\desoxyriboseHaw N !\cytosine }
\definesubmol{\desoxyGuanosineHaw}{ !\desoxyriboseHaw N !\guanine }
\definesubmol{\desoxyThymidineHaw}{ !\desoxyriboseHaw N !\thymine }
\definesubmol{\desoxyUridineHaw}  { !\desoxyriboseHaw N !\uracile }

%%%% Adenosine Tri-Phosphate et Adenosine Di-Phosphate
\definesubmol{\tetePhosphate}{ \charge{45:1.5pt=$\scriptstyle -$}{O} -!\phosphate }
\definesubmol{\ADP}{ !\tetePhosphate -!\phosphate !\adenosine }
\definesubmol{\ATP}{ !\tetePhosphate -!\phosphate -!\phosphate !\adenosine}
\definesubmol{\ADPHaw}{ !\tetePhosphate !\adenosineHaw }
\definesubmol{\ATPHaw}{ !\tetePhosphate -!\phosphate -!\phosphate !\adenosineHaw}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Acides alpha aminés, formules topologiques
\definesubmol\acideAmine1{ H_2N -[::30] (#1) !\cd !\carboxyle }
\definesubmol\arginine       { !\acideAmine{!\cu!\cud!\cu HN -[::-60,,2] (!\cd NH_2) !\ccu H_2N^{+}} }
\definesubmol\histidine      { !\acideAmine{!\cu!\cu *5(-N=-HN-=)} }
\definesubmol\lysine         { !\acideAmine{!\cu!\cud!\cud NH_3^{+}} }
\definesubmol\acideAspartique{ !\acideAmine{!\cu !\cu !\carbonyle O^{-}} }
\definesubmol\acideGlutamique{ !\acideAmine{!\cu !\cud !\carbonyle O^{-}} }
\definesubmol\serine         { !\acideAmine{!\cu!\cu HO} }
\definesubmol\threonine      { !\acideAmine{!\cu (!\cu HO) !\cd} }
\definesubmol\asparagine     { !\acideAmine{!\cu!\cu (!\ccd O) !\cu H_2N} }
\definesubmol\glutamine      { !\acideAmine{!\cu!\cud (!\ccu O) !\cd H_2N} }
\definesubmol\cysteine       { !\acideAmine{!\cu!\cu HS} }
\definesubmol\selenocysteine { !\acideAmine{!\cu!\cu HSe} }
\definesubmol\glycine        { !\acideAmine{} }
\definesubmol\proline        { !\acideAmine{!\cu *5(----HN-)} }
\definesubmol\alanine        { !\acideAmine{!\cu} }
\definesubmol\valine         { !\acideAmine{!\cu (!\cd) !\cu} }
\definesubmol\isoleucine     { !\acideAmine{!\cu (!\cd) !\cud} }
\definesubmol\leucine        { !\acideAmine{!\cu!\cu (!\cd) !\cu} }
\definesubmol\methionine     { !\acideAmine{!\cu!\cu!\cd S !\cu} }
\definesubmol\phenylalanine  { !\acideAmine{!\cu!\cu *6(=-=-=-)} }
\definesubmol\tyrosine       { !\acideAmine{!\cu!\cu *6(=-=(-OH)-=-)} }
\definesubmol\tryophane      { !\acideAmine{!\cu!\cu *5(- *6(-=-=-) =-HN-=)} }
%% Acides alpha aminés, formules semi-developpée
\definesubmol\acideAmineSD{ CH (-[::-90] NH_2) -C !\carboxyleDev }
\definesubmol\alanineSemiDev   { CH_3 - !\acideAmineSD }
\definesubmol\asparagineSemiDev{ C (=[::-120] O) (-[::120] H_2N) -CH_2 -CH_2 - !\acideAmineSD }
\definesubmol\glycineSemiDev   { CH_2 - !\acideAmineSD }
\definesubmol\cysteineSemiDev  { HS -CH_2 - !\acideAmineSD }

%% Pour faire des polypeptides en formule topologique H = haut, B = bas
\definesubmol\acideAmineH1{ !\cu (#1) !\cd (!\ccd O) !\cu }
\definesubmol\acideAmineB1{ !\cd (#1) !\cu (!\ccu O) !\cd }
\definesubmol\arginineH       { !\acideAmineH{!\cu!\cud!\cu HN -[::-60,,2] (!\cd NH_2) !\ccu H_2N^{+}} }
\definesubmol\arginineB       { !\acideAmineB{!\cd!\cdu!\cd HN -[::60,,2]  (!\cu NH_2) !\ccd H_2N^{+}} }
\definesubmol\histidineH      { !\acideAmineH{!\cu!\cd *5(-N=-\chemabove{N}{H}-=)} }
\definesubmol\histidineB      { !\acideAmineB{!\cd!\cu *5(-N=-HN-=)} }
\definesubmol\lysineH         { !\acideAmineH{!\cu!\cud!\cud NH_3^{+}} }
\definesubmol\lysineB         { !\acideAmineB{!\cd!\cdu!\cdu NH_3^{+}} }
\definesubmol\acideAspartiqueH{ !\acideAmineH{!\cu !\cd !\carbonyle O^{-}} }
\definesubmol\acideAspartiqueB{ !\acideAmineB{!\cd !\cu !\carbonyle O^{-}} }
\definesubmol\acideGlutamiqueH{ !\acideAmineH{!\cu !\cud !\carbonyle O^{-}} }
\definesubmol\acideGlutamiqueB{ !\acideAmineB{!\cd !\cdu !\carbonyle O^{-}} }
\definesubmol\serineH         { !\acideAmineH{!\cu!\cd HO} }
\definesubmol\serineB         { !\acideAmineB{!\cd!\cu HO} }
\definesubmol\threonineH      { !\acideAmineH{!\cu (!\cd HO) !\cu} }
\definesubmol\threonineB      { !\acideAmineB{!\cd (!\cu HO) !\cd} }
\definesubmol\asparagineH     { !\acideAmineH{!\cu!\cd (!\ccd O) !\cu NH_2} }
\definesubmol\asparagineB     { !\acideAmineB{!\cd!\cu (!\ccu O) !\cd NH_2} }
\definesubmol\glutamineH      { !\acideAmineH{!\cu!\cud (!\ccu O) !\cd H_2N} }
\definesubmol\glutamineB      { !\acideAmineB{!\cd!\cdu (!\ccd O) !\cu H_2N} }
\definesubmol\cysteineH       { !\acideAmineH{!\cu!\cd HS} }
\definesubmol\cysteineB       { !\acideAmineB{!\cd!\cu HS} }
\definesubmol\selenocysteineH { !\acideAmineH{!\cu!\cd HSe} }
\definesubmol\selenocysteineB { !\acideAmineB{!\cd!\cu HSe} }
\definesubmol\prolineH        { !\acideAmineH{!\cu *5(----HN-)} }
\definesubmol\prolineB        { !\acideAmineB{!\cd *5(----HN-)} }
\definesubmol\alanineH        { !\acideAmineH{!\cu} }
\definesubmol\alanineB        { !\acideAmineB{!\cd} }
\definesubmol\valineH         { !\acideAmineH{!\cu (!\cd) !\cu} }
\definesubmol\valineB         { !\acideAmineB{!\cd (!\cd) !\cu} }
\definesubmol\isoleucineH     { !\acideAmineH{!\cu (!\cd) !\cdu} }
\definesubmol\isoleucineB     { !\acideAmineB{!\cd (!\cd) !\cud} }
\definesubmol\leucineH        { !\acideAmineH{!\cu!\cd (!\cd) !\cu} }
\definesubmol\leucineB        { !\acideAmineB{!\cd!\cu (!\cd) !\cu} }
\definesubmol\methionineH     { !\acideAmineH{!\cu!\cd!\cu S !\cd} }
\definesubmol\methionineB     { !\acideAmineB{!\cd!\cu!\cd S !\cu} }
\definesubmol\phenylalanineH  { !\acideAmineH{!\cu!\cd *6(=-=-=-)} }
\definesubmol\phenylalanineB  { !\acideAmineB{!\cd!\cu *6(=-=-=-)} }
\definesubmol\tyrosineH       { !\acideAmineH{!\cu!\cd *6(=-=(-OH)-=-)} }
\definesubmol\tyrosineB       { !\acideAmineB{!\cd!\cu *6(=-=(-OH)-=-)} }
\definesubmol\tryophaneH      { !\acideAmineH{-[::70]-[::-40] *5(- *6(-=-=-) =-\chemabove{N}{H}-=)} }
\definesubmol\tryophaneB      { !\acideAmineB{!\cd!\cu *5(- *6(-=-=-) =-NH-=)} }
%% Pour faire des polypeptides en formule semi-développée 
\definesubmol\cysteineSemiDevB  {-CH_2 -CH (-[-3] NH_2) -C (=[3] O) -}
\definesubmol\alanineSemiDevB   {-CH (-[-3] CH_3) -C (=[3] O) -}
\definesubmol\glycineSemiDevH   {-CH_2 -C (=[3] O) -}
\definesubmol\isoleucineSemiDevB{-CH (-[-3] CH (-[-5] CH_2 -[-3]CH_3) -[-1]CH_2) -C (=[3]) -}
\definesubmol\valineSemiDevH    {-CH (-[3] CH (-[5] CH_3) -[1]CH_2) -C (=[-3] O) -}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Hormones
\definesubmol\creatinine{
  O= *5(-N (-[-3,0.5]H) -(=NH) -N (-) --)
}
\definesubmol\DOPA{
  HO -[1] *6(= (-OH) -= (--[-1] (-[-3] NH_2) -[1] !\carboxyle) -=-)
}
\definesubmol\DOPAH{
  HO -[1] *6(= (-OH) -= (--[-1] (-[-3] NH_3^+) -[1] !\carboxyle) -=-)
}
\definesubmol\prostaglandine{
  HO-[::75] *5(
    - (-!\ccu !\cd (!\cd HO) !\cud !\cud !\cu)
    - (-[::-65] !\cdu !\cdu !\cdu !\carboxyle)
    - (=O)
    --
  )
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Produit de contraste
\definesubmol\chelate{-[::-70] -[::80] -[::80]} 
\definesubmol\chelateCOO{-[::-120] !\cd (!\ccd O) !\cu O^{-}}
\definesubmol\ionChelate{
  [:-10] N (-[::50, 0.9,,, draw = none] Gd^{3+})
    (!\chelateCOO) !\chelate
  N (!\chelateCOO) !\chelate
  N (!\chelateCOO) !\chelate 
  N (!\chelateCOO) -[::-70] -[::80] -[::80,0.75]
}
\definesubmol\chelateAlcool{
  [:-10] N (-[::50, 0.9,,, draw = none] Gd^{3+})
    (!\chelateCOO) !\chelate
  N (!\chelateCOO) !\chelate
  N (-[::-120] !\cd (!\cd) !\cu O) !\chelate 
  N (!\chelateCOO) -[::-70] -[::80] -[::80,0.75]
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Vitamines
\definesubmol\acideAscorbique{ % Vitamine C
  HO-[-1] -[1](-[3]OH) -[-1] 
  *5(
    -(-OH) =(-OH) -(=O) -O-
  )
}
\definesubmol\cholecarciferol{ % Vitamine D
  OH-[-1]
  *6( % 1er cycle
    ---(=)- ( % ramification
      = !\cd !\ccu *6(- % 2eme
        *5(
          --- (-(-[::60]) !\cd !\cud -[::60](-[::60]) !\cd) --
        ) % 3eme
        -(-[::0])----
      ) % 2eme
    ) % ramification
    --
  ) % 1er
}
\definesubmol\cret{ !\ccd !\cu }
\definesubmol\retinol{ % Vitamine A
  *6( % cycle
    --(-[::0]) (-[::-80]) = ( % chaine
      !\cd !\cret (!\cu) !\cret !\cret (!\cu) !\cret !\cd OH
    ) % chaine
    -(-)--
  ) % cycle
}
% vitamine B1 thiamine
\definesubmol\thiamine{
  -[::30]  *6(
    -N=- (
      - !\cd N  *5(
        - (-)
        = (- !\cu !\cd OH)
        -S-=
      ) % 2nd cycle
    )
    = (-  NH_2)
    -N=
  ) % 1er cycle
}
% vitamine B2 riboflavine
\definesubmol\riboflavine{
  -[::30]  *6(
    =- ( *6(
        - N (
        !\cdu (!\cu OH)
        !\cd (!\cd OH)
        !\cu (!\cu OH)
        !\cd !\cu OH
      )
      - ( *6(=N- (=O) -NH- (= O)-) )
      -=N-
    ))
    =-= (-) -
  )
}
% vitamine B3 acide nicotinique
\definesubmol\acideNicotinique{
   *6(-N=- (- (!\ccu O) !\cd OH) =-=)
}
% vitamine B5 acide panthotenique
\definesubmol\acidePanthotenique{
  HO -[::30] !\cd (-[::-90]) (-[::-30])
  !\cu ( !\cu OH )
  !\cd (!\ccd O )
  !\cu \chemabove{N}{H} !\cdu !\cd (!\ccd O)
  !\cu OH
}
% vitamine B6 pyroxidine
\definesubmol\pyroxidine{
  HO -[::30] !\cd  *6(
    =-N= (-)
    - (-OH)
    = (!\cd OH)
    -
  )
}
% vitamine B8 biotine
\definesubmol\biotine{
  \chembelow{N}{H} *5(
    - *5(--S- (- !\cdu !\cd) -)
    --\chemabove{N}{H}- (= HO)
    -
  )
}
% vitamine B9 acide folique
\definesubmol\acideFolique{
  H_2N -[::30]  *6(
    =N- *6(
      -N=- (
        - !\cu \chemabove{N}{H} !\cd  *6(
          =-= (
            - (!\ccu O)
            !\cd \chembelow{N}{H} !\cu (!\cu (!\cu HO) !\ccd O)
            !\cd !\cdu (!\cu OH) !\ccd O
          )
          -=-
        ) % 3eme cycle
      )
      =N-
    ) % 2nd cycle
    =- (=O) -N-
  ) % 1er cycle
}
% vitamine B12 cyanocobalamine
\definesubmol\cyanocobalamine{
  -[::-5]  *5( % cycle haut droit du cobalt
    (-[::150] -[::-50] (!\ccd O) !\cu NH_2)
    - (-[::-90]) (-[::-35])
    - N = (
      - (!\cu) !\ccd *5( % cycle haut gauche du cobalt
        - N = (
          -!\ccd *5( % cycle bas gauche du cobalt
            - N = (
              - (!\cu) !\ccd *5( % cobalt
                - N (-Co !\cu CN)
                -- (- !\cd (!\ccd O) !\cu NH_2)
                - (-[::-90]) ( % Phosphate
                  - !\cud (!\ccd O) !\cu NH !\cdu (!\cu)
                  !\cd O !\cu !\phosphate -[::0] *5( % cycle du bas ether
                    - (- !\cu HO)
                    -O- (-N  *5(- *6(=-(-)=(-)-=) --N=-)) % Cycle du bas amidine
                    -(-OH)-
                  )
                )
                -
              )
            ) % amide latéral
            - (- !\cud (!\ccd O) !\cu NH_2)
            - (-[::-30])  (-[::-90]) -
          )
        ) % cycle 
        - (- !\cdu (!\ccu O) !\cd NH_2)
        - (-[::0]) (!\cd!\cd (!\ccu O) !\cd NH_2)
        -
      )
    )
    - (- !\cdu (!\ccd O) !\cu NH_2)
    - 
  ) % 1er cycle
}
% vitamine E
\definesubmol\vitamineE{
  -[::30]  *6(
    = (-) -  *6(
      -O- (
        - !\cud !\cu (!\cu)
        !\cdu !\cdu (!\cu)
        !\cdu !\cdu (!\cu) !\cd
      )
      ( -[::0] )
      ---
    ) % 2nd cycle
    =- (-) = ( -HO )
    -
  ) % 1er cycle
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Aspirine
\definesubmol\aspirineSemiDev{
  HC *6( % cycle
    -\chembelow{C}{H} =CH -C (
      -O !\cd C (!\ccd O) !\cu CH_3 % chaine latérale
    )
    =C (-C !\carboxyle) -[,,,2]HC =[,,2]
  ) % cyle
}
\definesubmol\aspirine{
  *6 (-=- (-O !\cd (!\ccd O) !\cu) = (- !\carboxyle) -=)
}
\definesubmol\acideSalicylique{
  *6 (-=- (-OH) = (- !\carboxyle) -=)
}

%% Paracétamol
\definesubmol\paracetamol{
  HO -[::30] *6(
    -=- (
      -\chemabove{N}{H} (!\cd (!\ccd O) !\cu) % amide
    )
    =-=
  )
}
\definesubmol\paracetamolSemiDev{
  HO -[::30] C *6(
    -\chembelow{C}{H} =CH -C (
      -\chemabove{N}{H} (!\cd C (!\ccd O) -CH_3) % amide
    )
    =\chemabove{C}{H} -HC =[,,2]
  )
}
\definesubmol\paracetamolDev{
  H -[::0] O -[::30] C *6(
    -C (-H) =C (-H) -C (
      -N (!\cu H) (!\cd C (!\ccd O) (-C !\HHH)) % amide
    )
    =C (-H) -C (-H) =
  )
}

%% Aspartame
\definesubmol\aspartame{
  HO -[::90] (!\ccu O) !\cd!\cd (!\cd NH_2) % chaine latérale
  !\cu (!\ccu O) !\cd \chembelow{N}{H} !\cu % amide
  *6(- (=O) -O (-) !\blank *6(-=-=-) =--) % double cycle
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Molécules odorantes
\definesubmol\geraniol{
  -[::30] (!\cd) !\ccu *6( % pied
    !\blank !\blank (- !\cd OH) % chaine latérale
    =(-)--- %fin du cycle
  )
}
\definesubmol\geraniolSemiDev{
  H_3C - C (- CH_3) =[::90] CH % pied
  !\cu H_2C -[::-60,,2,2] H_2C !\cd C % "cycle"
  (!\cu CH_3) !\ccd CH -[::30] CH_2 -OH % chaînes latérales
}
\definesubmol\vanilline{
  HO -[::90,,2] *6(= (-O !\cu) -= (- !\carbonyle H) -=-)
}
\definesubmol\ethylvanilline{
  HO -[::90,,2] *6(= (-O !\cud) -= (- !\carbonyle H) -=-)
}
\definesubmol\oxyphenylone{
  HO -[::30] *6(-=- (-!\cdu (!\ccu O) !\cd) =-=)
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Drogues
\definesubmol\THC{
  -[::30] *6( % cyle ether
    (-[::50]) -O- *6( % cycle chaine latérale et alcool
      -= (!\cdu !\cdu !\cd) -= (-OH) -
    )
    =- *6(-=(-)---) -- % cycle supérieur
  )
}
\definesubmol\cocaineHaw{
  ? 
    <[::60,0.7] (-[::60] N -[::60])
    -[::-60,,,,line width = 3pt]
    >[::-30,0.7] ( % ether-phenyl
      !\cu O !\cd (!\ccd O) !\cu *6(=-=-=-)
    )
    -[::130,0.7] ( % ester
      -[::-50] (!\ccu O)
      !\cd O !\cu 
    )
    -[::80, 0.9] (-[::-30, 0.85]) -[::60, 0.7] 
  ?
}